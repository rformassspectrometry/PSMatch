<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Understanding protein groups with adjacency matrices • PSMatch</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Understanding protein groups with adjacency matrices">
<meta property="og:description" content="PSMatch">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PSMatch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AdjacencyMatrix.html">Understanding protein groups with adjacency matrices</a>
    </li>
    <li>
      <a href="../articles/Fragments.html">MS2 fragment ions</a>
    </li>
    <li>
      <a href="../articles/PSM.html">Working with PSM data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RforMassSpectrometry/PSM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Understanding protein groups with adjacency matrices</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/PSM/blob/HEAD/vignettes/AdjacencyMatrix.Rmd" class="external-link"><code>vignettes/AdjacencyMatrix.Rmd</code></a></small>
      <div class="hidden name"><code>AdjacencyMatrix.Rmd</code></div>

    </div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><p><strong>Package</strong>: <em><a href="https://bioconductor.org/packages/3.15/PSMatch" class="external-link">PSMatch</a></em><br><strong>Authors</strong>: Laurent Gatto [aut, cre] (<a href="https://orcid.org/0000-0002-1520-2268" class="external-link uri">https://orcid.org/0000-0002-1520-2268</a>), Johannes Rainer [aut] (<a href="https://orcid.org/0000-0002-6977-7147" class="external-link uri">https://orcid.org/0000-0002-6977-7147</a>), Sebastian Gibb [aut], Samuel Wieczorek [ctb], Thomas Burger [ctb]<br><strong>Last modified:</strong> 2022-02-14 17:14:29<br><strong>Compiled</strong>: Mon Feb 14 17:22:10 2022</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette is one among several illustrating how to use the <code>PSMatch</code> package, focusing on the modelling peptide-protein relations using adjacency matrices and connected componencts. For a general overview of the package, see the <code>PSMatch</code> package manual page (<code><a href="../reference/PSMatch.html">?PSMatch</a></code>) and references therein.</p>
</div>
<div class="section level2">
<h2 id="peptide-protein-relation">Peptide-protein relation<a class="anchor" aria-label="anchor" href="#peptide-protein-relation"></a>
</h2>
<p>Let’s start by loading and filter PSM data as illustrated in the <a href="https://rformassspectrometry.github.io/PSMatch/articles/PSM.html" class="external-link"><em>Working with PSM data</em></a> vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/RforMassSpectrometry/PSM" class="external-link">"PSMatch"</a></span><span class="op">)</span>
<span class="va">id</span> <span class="op">&lt;-</span> <span class="fu">msdata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/msdata/man/proteomics.html" class="external-link">ident</a></span><span class="op">(</span>full.names <span class="op">=</span> <span class="cn">TRUE</span>, pattern <span class="op">=</span> <span class="st">"TMT"</span><span class="op">)</span> |&gt;
<span class="fu"><a href="../reference/PSM.html">PSM</a></span><span class="op">(</span><span class="op">)</span> |&gt;
<span class="fu"><a href="../reference/filterPSMs.html">filterPsmDecoy</a></span><span class="op">(</span><span class="op">)</span> |&gt;
<span class="fu"><a href="../reference/filterPSMs.html">filterPsmRank</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Loading required namespace: mzR</span></code></pre>
<pre><code><span class="co">## Removed 2896 decoy hits.</span></code></pre>
<pre><code><span class="co">## Removed 155 PSMs with rank &gt; 1.</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">id</span></code></pre></div>
<pre><code><span class="co">## PSM with 2751 rows and 35 columns.</span>
<span class="co">## names(35): sequence spectrumID ... subReplacementResidue subLocation</span></code></pre>
<p>When identification data is stored as a table, the relation between peptides is typically encode in two columns, once containing the peptide sequences and the second the protein identifiers these peptides stem from. Below are the 10 first observations of our identification data table.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sequence"</span>, <span class="st">"DatabaseAccess"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                             sequence DatabaseAccess</span>
<span class="co">## 1                       RQCRTDFLNYLR        ECA2006</span>
<span class="co">## 2             ESVALADQVTCVDWRNRKATKK        ECA1676</span>
<span class="co">## 3             QRMARTSDKQQSIRFLERLCGR        ECA3009</span>
<span class="co">## 4          DGGPAIYGHERVGRNAKKFKCLKFR        ECA1420</span>
<span class="co">## 5             QRMARTSDKQQSIRFLERLCGR        ECA3009</span>
<span class="co">## 6  CIDRARHVEVQIFGDGKGRVVALGERDCSLQRR        ECA2142</span>
<span class="co">## 7  CIDRARHVEVQIFGDGKGRVVALGERDCSLQRR        ECA2142</span>
<span class="co">## 8               VGRCRPIINYLASPGGTSER        ECA0331</span>
<span class="co">## 9                QRLDEHCVGVGQNALLLGR        ECA3680</span>
<span class="co">## 10  VDYQGKKVVIIGLGLTGLSCVDFFLARGVVPR        ECA3817</span></code></pre>
<p>This information can however also be encoded as an adjacency matrix with peptides along the rows and proteins along the columns, and a 1 (or more generally a value &gt; 0) indicating that a peptides belongs to the corresponding proteins. Such a matrix is created below for our identification data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjacencyMatrix.html">makeAdjacencyMatrix</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">adj</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 2357 1504</span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">adj</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">## 5 x 5 sparse Matrix of class "dgCMatrix"</span>
<span class="co">##                                   ECA2006 ECA1676 ECA3009 ECA1420 ECA2142</span>
<span class="co">## RQCRTDFLNYLR                            1       .       .       .       .</span>
<span class="co">## ESVALADQVTCVDWRNRKATKK                  .       1       .       .       .</span>
<span class="co">## QRMARTSDKQQSIRFLERLCGR                  .       .       2       .       .</span>
<span class="co">## DGGPAIYGHERVGRNAKKFKCLKFR               .       .       .       1       .</span>
<span class="co">## CIDRARHVEVQIFGDGKGRVVALGERDCSLQRR       .       .       .       .       2</span></code></pre>
<p>This matrix models the relation between the 2357 peptides and the 1504 is our identification data. These numbers can be verified by checking the number of unique peptides sequences and database accession numbers.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">$</span><span class="va">sequence</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 2357</span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">$</span><span class="va">DatabaseAccess</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1504</span></code></pre>
<p>Some values are &gt; 1 because some peptide sequences are observed more than oncce, for example carrying different modification or the same one at different sites. The adjacency matrix can be made binary by setting <code>madeAdjacencyMatrix(id, binary = TRUE)</code>.</p>
<p>This large matrix is too large to be explored manually and is anyway not interesting on its own. Subsets of this matrix that define proteins defines by a set of peptides (whether shared or unique) is relevant. These are represented by subsets of this large matrix named connected component. We can easily compute all these connected components to produce the multiple smaller and relevant adjacency matrices.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ConnectedComponents.html">ConnectedComponents</a></span><span class="op">(</span><span class="va">adj</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1476</span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cc</span></code></pre></div>
<pre><code><span class="co">## An instance of class ConnectedComponents </span>
<span class="co">##  Number of proteins: 1504 </span>
<span class="co">##  Number of components: 1476 </span>
<span class="co">##  Number of components [peptide x peptides]:</span>
<span class="co">##   954[1 x 1] 7[1 x n] 501[n x 1] 14[n x n]</span></code></pre>
<p>Among the 2357 and the 1504 proteins, we have 1476 connected components.</p>
<p>954 thereof, such as the one shown below, correspond to single proteins identified by a single peptide:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ConnectedComponents.html">connectedComponents</a></span><span class="op">(</span><span class="va">cc</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## 1 x 1 sparse Matrix of class "dgCMatrix"</span>
<span class="co">##                        ECA0003</span>
<span class="co">## KTLGAYDFSFGEGIYTHMKALR       1</span></code></pre>
<p>7 thereof represent protein groups identified by a single shared peptide:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ConnectedComponents.html">connectedComponents</a></span><span class="op">(</span><span class="va">cc</span>, <span class="fl">527</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## 1 x 2 sparse Matrix of class "dgCMatrix"</span>
<span class="co">##            ECA1637 ECA2914</span>
<span class="co">## KEIILNKNEK       1       1</span></code></pre>
<p>501 represent single proteins identified by multiple unique peptides:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ConnectedComponents.html">connectedComponents</a></span><span class="op">(</span><span class="va">cc</span>, <span class="fl">38</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## 5 x 1 sparse Matrix of class "dgCMatrix"</span>
<span class="co">##                               ECA0130</span>
<span class="co">## GKIECNLRFELDPSAQSALILNEKLAK         1</span>
<span class="co">## ERLQSKLEDAQVQLENNRLEQELVLMAQR       1</span>
<span class="co">## GNWGSAAWELRSVNQR                    1</span>
<span class="co">## ILKKEEAVGRR                         1</span>
<span class="co">## ERIRARLTR                           1</span></code></pre>
<p>Finally, arguable those that warrant additional exploration are those that are composed of multiple peptides and multiple proteins. There are 14 thereof in this identification; here’s an example:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ConnectedComponents.html">connectedComponents</a></span><span class="op">(</span><span class="va">cc</span>, <span class="fl">920</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## 4 x 2 sparse Matrix of class "dgCMatrix"</span>
<span class="co">##                    ECA2869 ECA4278</span>
<span class="co">## QKTRCATRAFKANKGRAR       1       1</span>
<span class="co">## IDFLRDPKGYLR             1       .</span>
<span class="co">## RFKQKTR                  .       1</span>
<span class="co">## LIRKQVVQPGYR             1       1</span></code></pre>
</div>
<div class="section level2">
<h2 id="visualising-adjacency-matrices">Visualising adjacency matrices<a class="anchor" aria-label="anchor" href="#visualising-adjacency-matrices"></a>
</h2>
<p>Let’s identify the connected components that have at least 3 peptides (i.e. rows in the adjacency matrix) and 3 proteins (i.e. columns in the adjacency matrix).</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">nrows</span><span class="op">(</span><span class="va">cc</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="fu">ncols</span><span class="op">(</span><span class="va">cc</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1079 1082</span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">dims</span><span class="op">(</span><span class="va">cc</span><span class="op">)</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></code></pre></div>
<pre><code><span class="co">##      nrow ncol</span>
<span class="co">## [1,]    3    4</span>
<span class="co">## [2,]    7    4</span></code></pre>
<p>We will use the second adjacency matrix, with index 1082 to learn about the <code><a href="../reference/adjacencyMatrix.html">plotAdjacencyMatrix()</a></code> function and explore how to inform our peptides filtering beyond the <code>filterPsm*()</code> functions.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ConnectedComponents.html">connectedComponents</a></span><span class="op">(</span><span class="va">cc</span>, <span class="fl">1082</span><span class="op">)</span>
<span class="va">cx</span></code></pre></div>
<pre><code><span class="co">## 7 x 4 sparse Matrix of class "dgCMatrix"</span>
<span class="co">##                     ECA3406 ECA3415 ECA3389 ECA3399</span>
<span class="co">## THPAERKPRRRKKR            1       1       .       .</span>
<span class="co">## KPTARRRKRK                .       .       2       .</span>
<span class="co">## PLAQGGQLNRLSAIRGLFR       1       1       .       .</span>
<span class="co">## RRKRKPDSLKK               .       .       1       .</span>
<span class="co">## KPRRRK                    1       1       .       .</span>
<span class="co">## VVPVGLRALVWVQR            1       1       1       1</span>
<span class="co">## KLKPRRR                   .       .       .       1</span></code></pre>
<p>We can now visualise the the <code>cx</code> adjacency matrix with the <code><a href="../reference/adjacencyMatrix.html">plotAdjacencyMatrix()</a></code> function. The nodes of the graph represent proteins and petides - by default, proteins are shown as blue squares and peptides as white circles. Edge connect peptides/circles to proteins/squares, indicating that a peptide belongs to a protein.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/adjacencyMatrix.html">plotAdjacencyMatrix</a></span><span class="op">(</span><span class="va">cx</span><span class="op">)</span></code></pre></div>
<p><img src="AdjacencyMatrix_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>We can immediately observe that peptide <code>VVPVGLRALVWVQR</code> is associated to all four proteins; it holds that protein group together, defines that connected component formed by these four proteins. If we were to drop that peptides, we would obtain two single proteins, <code>ECA3399</code> (defined by <code>KLKPRRR</code>), <code>ECA3398</code> (defined by <code>RRKRKPDSLKK</code> and <code>KPTARRRKRK</code>) and a protein group formed of <code>ECA3415</code> and <code>ECA3406</code> (defined by three shared peptides).</p>
<div class="section level3">
<h3 id="colouring-the-graph-nodes">Colouring the graph nodes<a class="anchor" aria-label="anchor" href="#colouring-the-graph-nodes"></a>
</h3>
<p>To help with the interpretation of the graph and the potential benefits of additional manual peptide filtering, it is possible to customise the node colours. Protein and peptide node colours can be controlled with the <code>protColors</code> and <code>pepColors</code> arguments respectively. Let’s start with the former.</p>
<div class="section level4">
<h4 id="colouring-protein-nodes">Colouring protein nodes<a class="anchor" aria-label="anchor" href="#colouring-protein-nodes"></a>
</h4>
<p><code>protColors</code> can either be a numeric or a character. The default value is 0, which produces the figure above. Any value &gt; 0 will lead to more proteins being highlighted using different colours. Internally, string distances between protein names are computed and define if proteins should be coded with the same colours (if they are separated by small distances, i.e. they have similar names) or different colours (large distance, dissimilar names).</p>
<p>By setting the argument to 1, we see that proteins starting with <code>ECA33</code> and those starting with <code>ECA34</code> are represented with different colours.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/adjacencyMatrix.html">plotAdjacencyMatrix</a></span><span class="op">(</span><span class="va">cx</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="AdjacencyMatrix_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>We can further distinguish <code>ECA3406</code>, and <code>ECA314</code> and <code>ECA33*9</code> by setting <code>protColors</code> to 2.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/adjacencyMatrix.html">plotAdjacencyMatrix</a></span><span class="op">(</span><span class="va">cx</span>, <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="AdjacencyMatrix_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p><code>protColors</code> can also be a character of colours named by protein names. We will illustrate this use below, as it functions the same way as <code>pepColors</code>.</p>
</div>
<div class="section level4">
<h4 id="colouring-peptide-nodes">Colouring peptide nodes<a class="anchor" aria-label="anchor" href="#colouring-peptide-nodes"></a>
</h4>
<p><code>pepColors</code> can either be <code>NULL</code> to represent peptides as white nodes (as we have seen in all examples above). Alternatively, it can be set to a character of colours names after the peptides sequences. Let’s use the search engine score (here <code>MS.GF.RawScore</code>) to annotate the peptide nodes.</p>
<p>We can extract this metric from the PSM object we started with and create a colour palette representing the range of scores.</p>
<p>The named vector of scores:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">score</span> <span class="op">&lt;-</span> <span class="va">id</span><span class="op">$</span><span class="va">MS.GF.RawScore</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">id</span><span class="op">$</span><span class="va">sequence</span>
<span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">head</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                      RQCRTDFLNYLR            ESVALADQVTCVDWRNRKATKK </span>
<span class="co">##                                10                                12 </span>
<span class="co">##            QRMARTSDKQQSIRFLERLCGR         DGGPAIYGHERVGRNAKKFKCLKFR </span>
<span class="co">##                                -5                                 7 </span>
<span class="co">##            QRMARTSDKQQSIRFLERLCGR CIDRARHVEVQIFGDGKGRVVALGERDCSLQRR </span>
<span class="co">##                                21                               -31</span></code></pre>
<p>The matching named vector of colours:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">score</span>, <span class="fl">12</span>,
                        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cls</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">id</span><span class="op">$</span><span class="va">sequence</span>
<span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cls</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                      RQCRTDFLNYLR            ESVALADQVTCVDWRNRKATKK </span>
<span class="co">##                         "#FFA2A2"                         "#FFA2A2" </span>
<span class="co">##            QRMARTSDKQQSIRFLERLCGR         DGGPAIYGHERVGRNAKKFKCLKFR </span>
<span class="co">##                         "#FFB9B9"                         "#FFA2A2" </span>
<span class="co">##            QRMARTSDKQQSIRFLERLCGR CIDRARHVEVQIFGDGKGRVVALGERDCSLQRR </span>
<span class="co">##                         "#FFA2A2"                         "#FFD0D0"</span></code></pre>
<p>Below, we see that all these peptides have relatively low scores (light red), and that two of the three of the <code>ECA34*</code> proteins have the highest scores.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/adjacencyMatrix.html">plotAdjacencyMatrix</a></span><span class="op">(</span><span class="va">cx</span>, pepColors <span class="op">=</span> <span class="va">cls</span><span class="op">)</span></code></pre></div>
<p><img src="AdjacencyMatrix_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="using-quantitative-data">Using quantitative data<a class="anchor" aria-label="anchor" href="#using-quantitative-data"></a>
</h2>
<p>To conclude this vignette, we show how this same data modelling and exploration cam be initiated from a quantitative dataset. We will use part of the CPTAC data that is available in the <code>msdata</code> package.</p>
<p>Once we have the path to the tsv data, we identify the columns that contain quantitation values (i.e. those starting with <code>Intensity.</code>) and them create a <code>SummarizedExperiment</code> using the <a href="https://rformassspectrometry.github.io/QFeatures/reference/readQFeatures.html" class="external-link">readSummarizedExperiment()</a> function from the <em><a href="https://bioconductor.org/packages/3.15/QFeatures" class="external-link">QFeatures</a></em> package.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">msdata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/msdata/man/proteomics.html" class="external-link">quant</a></span><span class="op">(</span>full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "cptac_a_b_peptides.txt"</span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Intensity\\."</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 56 57 58 59 60 61</span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/QFeatures" class="external-link">QFeatures</a></span><span class="op">)</span>
<span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/readQFeatures.html" class="external-link">readSummarizedExperiment</a></span><span class="op">(</span><span class="va">f</span>, ecol <span class="op">=</span> <span class="va">i</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></code></pre></div>
<p>Below, we create a vector of protein groups (not leading razor protein names) and name it using the peptide sequences.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prots</span> <span class="op">&lt;-</span> <span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">Proteins</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prots</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">Sequence</span>
<span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">head</a></span><span class="op">(</span><span class="va">prots</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                            AAAAGAGGAGDSGDAVTK </span>
<span class="co">##                        "sp|P38915|SPT8_YEAST" </span>
<span class="co">##                                     AAAALAGGK </span>
<span class="co">## "sp|Q3E792|RS25A_YEAST;sp|P0C0T4|RS25B_YEAST" </span>
<span class="co">##                                    AAAALAGGKK </span>
<span class="co">## "sp|Q3E792|RS25A_YEAST;sp|P0C0T4|RS25B_YEAST" </span>
<span class="co">##                                  AAADALSDLEIK </span>
<span class="co">##                        "sp|P09938|RIR2_YEAST" </span>
<span class="co">##                               AAADALSDLEIKDSK </span>
<span class="co">##                        "sp|P09938|RIR2_YEAST" </span>
<span class="co">##                                      AAAEEFQR </span>
<span class="co">##                       "sp|P53075|SHE10_YEAST"</span></code></pre>
<p>Below, the <code><a href="../reference/adjacencyMatrix.html">makeAdjacencyMatrix()</a></code> will split the protein groups into individual proteins using a <code>;</code> (used by default, so not required here) to construct the adjacency matrix, which itself can be used to compute the connected components.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjacencyMatrix.html">makeAdjacencyMatrix</a></span><span class="op">(</span><span class="va">prots</span>, split <span class="op">=</span> <span class="st">";"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">adj</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 11466  1718</span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">adj</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">## 3 x 3 sparse Matrix of class "dgCMatrix"</span>
<span class="co">##                    sp|P38915|SPT8_YEAST sp|Q3E792|RS25A_YEAST</span>
<span class="co">## AAAAGAGGAGDSGDAVTK                    1                     .</span>
<span class="co">## AAAALAGGK                             .                     1</span>
<span class="co">## AAAALAGGKK                            .                     1</span>
<span class="co">##                    sp|P0C0T4|RS25B_YEAST</span>
<span class="co">## AAAAGAGGAGDSGDAVTK                     .</span>
<span class="co">## AAAALAGGK                              1</span>
<span class="co">## AAAALAGGKK                             1</span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ConnectedComponents.html">ConnectedComponents</a></span><span class="op">(</span><span class="va">adj</span><span class="op">)</span>
<span class="va">cc</span></code></pre></div>
<pre><code><span class="co">## An instance of class ConnectedComponents </span>
<span class="co">##  Number of proteins: 1718 </span>
<span class="co">##  Number of components: 1452 </span>
<span class="co">##  Number of components [peptide x peptides]:</span>
<span class="co">##   139[1 x 1] 0[1 x n] 1163[n x 1] 150[n x n]</span></code></pre>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## R Under development (unstable) (2022-02-10 r81713)</span>
<span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">## Running under: Ubuntu 20.04.3 LTS</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span>
<span class="co">## [8] base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">##  [1] QFeatures_1.5.2             MultiAssayExperiment_1.21.5</span>
<span class="co">##  [3] SummarizedExperiment_1.25.3 Biobase_2.55.0             </span>
<span class="co">##  [5] GenomicRanges_1.47.6        GenomeInfoDb_1.31.4        </span>
<span class="co">##  [7] IRanges_2.29.1              MatrixGenerics_1.7.0       </span>
<span class="co">##  [9] matrixStats_0.61.0          PSMatch_0.99.0             </span>
<span class="co">## [11] S4Vectors_0.33.10           BiocGenerics_0.41.2        </span>
<span class="co">## [13] BiocStyle_2.23.1           </span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##  [1] Rcpp_1.0.8              msdata_0.35.2           lattice_0.20-45        </span>
<span class="co">##  [4] rprojroot_2.0.2         digest_0.6.29           R6_2.5.1               </span>
<span class="co">##  [7] evaluate_0.14           highr_0.9               zlibbioc_1.41.0        </span>
<span class="co">## [10] rlang_1.0.1             lazyeval_0.2.2          jquerylib_0.1.4        </span>
<span class="co">## [13] Matrix_1.4-0            rmarkdown_2.11          mzR_2.29.3             </span>
<span class="co">## [16] pkgdown_2.0.2.9000      textshaping_0.3.6       desc_1.4.0             </span>
<span class="co">## [19] BiocParallel_1.29.12    stringr_1.4.0           ProtGenerics_1.27.2    </span>
<span class="co">## [22] igraph_1.2.11           RCurl_1.98-1.6          DelayedArray_0.21.2    </span>
<span class="co">## [25] compiler_4.2.0          xfun_0.29               pkgconfig_2.0.3        </span>
<span class="co">## [28] systemfonts_1.0.3       htmltools_0.5.2         GenomeInfoDbData_1.2.7 </span>
<span class="co">## [31] bookdown_0.24           codetools_0.2-18        crayon_1.5.0           </span>
<span class="co">## [34] MASS_7.3-55             bitops_1.0-7            grid_4.2.0             </span>
<span class="co">## [37] jsonlite_1.7.3          AnnotationFilter_1.19.0 magrittr_2.0.2         </span>
<span class="co">## [40] MsCoreUtils_1.7.1       ncdf4_1.19              cli_3.2.0              </span>
<span class="co">## [43] stringi_1.7.6           cachem_1.0.6            XVector_0.35.0         </span>
<span class="co">## [46] fs_1.5.2                bslib_0.3.1             ragg_1.2.1             </span>
<span class="co">## [49] tools_4.2.0             purrr_0.3.4             parallel_4.2.0         </span>
<span class="co">## [52] fastmap_1.1.0           yaml_2.2.2              clue_0.3-60            </span>
<span class="co">## [55] cluster_2.1.2           BiocManager_1.30.16     memoise_2.0.1          </span>
<span class="co">## [58] knitr_1.37              sass_0.4.0</span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
