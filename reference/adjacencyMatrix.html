<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Convert to/from an adjacency matrix. — adjacencyMatrix • PSMatch</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Convert to/from an adjacency matrix. — adjacencyMatrix"><meta property="og:description" content="There are two ways that peptide/protein matches are commonly
stored: either as a vector or an adjacency matrix. The functions
described below convert between these two format."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PSMatch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/AdjacencyMatrix.html">Understanding protein groups with adjacency matrices</a>
    </li>
    <li>
      <a href="../articles/Fragments.html">MS2 fragment ions</a>
    </li>
    <li>
      <a href="../articles/PSM.html">Working with PSM data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/RforMassSpectrometry/PSM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Convert to/from an adjacency matrix.</h1>
    <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/PSM/blob/HEAD/R/adjacencyMatrix-create.R" class="external-link"><code>R/adjacencyMatrix-create.R</code></a>, <a href="https://github.com/RforMassSpectrometry/PSM/blob/HEAD/R/adjacencyMatrix-plot.R" class="external-link"><code>R/adjacencyMatrix-plot.R</code></a></small>
    <div class="hidden name"><code>adjacencyMatrix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>There are two ways that peptide/protein matches are commonly
stored: either as a vector or an adjacency matrix. The functions
described below convert between these two format.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">makeAdjacencyMatrix</span><span class="op">(</span>
  <span class="va">x</span>,
  split <span class="op">=</span> <span class="st">";"</span>,
  peptide <span class="op">=</span> <span class="fu"><a href="PSM.html">psmVariables</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="st">"peptide"</span><span class="op">]</span>,
  protein <span class="op">=</span> <span class="fu"><a href="PSM.html">psmVariables</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="st">"protein"</span><span class="op">]</span>,
  score <span class="op">=</span> <span class="fu"><a href="PSM.html">psmVariables</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="st">"score"</span><span class="op">]</span>,
  binary <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="fu">makePeptideProteinVector</span><span class="op">(</span><span class="va">m</span>, collapse <span class="op">=</span> <span class="st">";"</span><span class="op">)</span>

<span class="fu">plotAdjacencyMatrix</span><span class="op">(</span>
  <span class="va">m</span>,
  protColors <span class="op">=</span> <span class="fl">0</span>,
  pepColors <span class="op">=</span> <span class="cn">NULL</span>,
  layout <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/igraph/man/layout_nicely.html" class="external-link">layout_nicely</a></span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>Either an instance of class <code>PSM</code> or a <code>character</code>. See
example below for details.</p></dd>
<dt>split</dt>
<dd><p><code>character(1)</code> defining how to split the string of
protein identifiers (using <code><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit()</a></code>). Default is ";". If
<code>NULL</code>, splitting is ignored.</p></dd>
<dt>peptide</dt>
<dd><p><code>character(1)</code> indicating the name of the variable
that defines peptides in the <code>PSM</code> object. Default is the
<code>peptide</code> PSM variable as defined in <code><a href="PSM.html">psmVariables()</a></code>.</p></dd>
<dt>protein</dt>
<dd><p><code>character(1)</code> indicating the name of the variable
that defines proteins in the <code>PSM</code> object. Default is the
<code>peptide</code> PSM variable as defined in <code><a href="PSM.html">psmVariables()</a></code>.</p></dd>
<dt>score</dt>
<dd><p><code>character(1)</code> indicating the name of the variable
that defines PSM scores in the <code>PSM</code> object. Default is the
<code>score</code> PSM variable as defined in <code><a href="PSM.html">psmVariables()</a></code>. Ignored
when <code>NA</code> (which is the default value unless set by the user
when constructing the <code>PSM</code> object).</p></dd>
<dt>binary</dt>
<dd><p><code>logical(1)</code> indicates if the adjacency matrix
should be strictly binary. In such a case, PSMs matching the
same peptide but from different precursors (for example charge
2 and 3) or carrying different PTMs, are counted only
once. Default if <code>FALSE</code>. This also overrides any <code>score</code> that
would be set.</p></dd>
<dt>m</dt>
<dd><p>A peptide-by-protein adjacency matrix.</p></dd>
<dt>collapse</dt>
<dd><p><code>character(1)</code> indicating how to collapse protein
names for shared peptides. Default is <code>";"</code>.</p></dd>
<dt>protColors</dt>
<dd><p>Either a <code>numeric(1)</code> or a named <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>
of colour names. The numeric value indicates the protein
colouring level to use. If 0 (default), all protein nodes are
labelled in steelblue. For values &gt; 0, approximate string
distances (see <code><a href="https://rdrr.io/r/utils/adist.html" class="external-link">adist()</a></code>) between protein names are calculated
and nodes of proteins that have names that differ will be
coloured differently, with higher values leading to more
colours. While no maximum to this value is defined in the
code, it shouldn't be higher than the number of proteins. If a
character is used, it should be a character of colour names
named by protein identifiers. That vector should provide
colours for at least all proteins in the adjacency matrix <code>m</code>,
but more protein could be named. The latter is useful when
generating a colour vector for all proteins in a dataset and
use it for different adjacency matrix visualisations.</p></dd>
<dt>pepColors</dt>
<dd><p>Either <code>NULL</code> (default) for no peptide colouring
(white nodes) or a named <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> of colour names. It
should be a character of colour names named by peptide
identifiers. That vector should provide colours for at least
all peptides in the adjacency matrix <code>m</code>, but more peptides
could be named. The latter is useful when generating a colour
vector for all peptides in a dataset and use it for different
adjacency matrix visualisations.</p></dd>
<dt>layout</dt>
<dd><p>A graph layout, as defined in the <code>ipgraph</code>
package. Default is <code>layout_as_bipartite()</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A peptide-by-protein sparce adjacency matrix (or class
<code>dgCMatrix</code> as defined in the <code>Matrix</code> package) or
peptide/protein vector.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>makeAdjacencyMatrix()</code> function creates a peptide-by-protein
adjacency matrix from a <code>character</code> or an instance of class
<code><a href="PSM.html">PSM()</a></code>.</p>
<p>The character is formatted as <code>x &lt;- c("ProtA", "ProtB", "ProtA;ProtB", ...)</code>, as commonly encoutered in proteomics data
spreadsheets. It defines that the first peptide is mapped to
protein "ProtA", the second one to protein "ProtB", the third one
to "ProtA" and "ProtB", and so on. The resulting matrix contain
<code>length(x)</code> rows an as many columns as there are unique protein
idenifiers in <code>x</code>. The columns are named after the protein
idenifiers and the peptide/protein vector namesa are used to name
to matrix rows (even if these aren't unique).</p>
<p>The <code>makePeptideProteinVector()</code> function does the opposite
operation, taking an adjacency matrix as input and retruning a
peptide/protein vector. The matrix colnames are used to populate
the vector and the matrix rownames are used to name the vector
elements.</p>
<p>Note that when creating an adjacency matrix from a PSM object, the
matrix is not necessarily binary, as multiple PSMs can match the
same peptide (sequence), such as for example precursors with
different charge states. A binary matrix can either be generated
with the <code>binary</code> argument (setting all non-0 values to 1) or by
reducing the PSM object accordingly (see example below).</p>
<p>It is also possible to generate adjacency matrices populated with
identification scores or probabilites by setting the "score" PSM
variable upon construction of the PSM object (see <code><a href="PSM.html">PSM()</a></code> for
details). In case multiple PSMs occur, their respective scores get
summed.</p>
<p>The <code>plotAdjacencyMatrix()</code> function is useful to visualise small
adjacency matrices, such as those representing protein groups
modelled as connected components, as described and illustrated in
<code><a href="ConnectedComponents.html">ConnectedComponents()</a></code>. The function generates a graph modelling
the relation between proteins (represented as squares) and
peptides (represented as circes), which can further be coloured
(see the <code>protColors</code> and <code>pepColors</code> arguments). The function
invisibly returns the graph <code>igraph</code> object for additional tuning
and/or interactive visualisation using, for example
<code><a href="https://rdrr.io/pkg/igraph/man/tkplot.html" class="external-link">igraph::tkplot()</a></code>.</p>
<p>There exists some important differences in the creation of an
adjacency matrix from a PSM object or a vector, other than the
input variable itself:</p><ul><li><p>In a <code>PSM</code> object, each row (PSM) refers to an <em>individual</em>
proteins; rows/PSMs never refer to a protein group. There is
thus no need for a <code>split</code> argument, which is used exclusively
when creating a matrix from a character.</p></li>
<li><p>Conversely, when using protein vectors, such as those
illustrated in the example below or retrieved from tabular
quantitative proteomics data, each row/peptide is expected to
refer to protein groups and individual proteins (groups of size
1). These have to be split accordingly.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Laurent Gatto</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## -----------------------</span></span>
<span class="r-in"><span class="co">## From a character</span></span>
<span class="r-in"><span class="co">## -----------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Protein vector without names</span></span>
<span class="r-in"><span class="va">prots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ProtA"</span>, <span class="st">"ProtB"</span>, <span class="st">"ProtA;ProtB"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">prots</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 x 2 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ProtA ProtB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     .     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1     1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Named protein vector</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prots</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pep1"</span>, <span class="st">"pep2"</span>, <span class="st">"pep3"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">prots</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          pep1          pep2          pep3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       "ProtA"       "ProtB" "ProtA;ProtB" </span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">prots</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 x 2 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ProtA ProtB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep1     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep2     .     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep3     1     1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Back to vector</span></span>
<span class="r-in"><span class="va">vec</span> <span class="op">&lt;-</span> <span class="fu">makePeptideProteinVector</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span class="r-in"><span class="va">vec</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          pep1          pep2          pep3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       "ProtA"       "ProtB" "ProtA;ProtB" </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">prots</span>, <span class="va">vec</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ----------------------------</span></span>
<span class="r-in"><span class="co">## PSM object from a data.frame</span></span>
<span class="r-in"><span class="co">## ----------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">psmdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>psm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"psm"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">                    peptide <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pep"</span>, <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">                    protein <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Prot"</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">psmdf</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      psm peptide protein</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   psm1    pep1   ProtA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   psm2    pep1   ProtA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   psm3    pep2   ProtB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   psm4    pep2   ProtB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   psm5    pep3   ProtC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   psm6    pep4   ProtD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   psm7    pep6   ProtC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   psm8    pep7   ProtE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   psm9    pep8   ProtF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 psm10    pep8   ProtF</span>
<span class="r-in"><span class="va">psm</span> <span class="op">&lt;-</span> <span class="fu"><a href="PSM.html">PSM</a></span><span class="op">(</span><span class="va">psmdf</span>, peptide <span class="op">=</span> <span class="st">"peptide"</span>, protein <span class="op">=</span> <span class="st">"protein"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">psm</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM with 10 rows and 3 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(3): psm peptide protein</span>
<span class="r-in"><span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">psm</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 x 6 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ProtA ProtB ProtC ProtD ProtE ProtF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep1     2     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep2     .     2     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep3     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep4     .     .     .     1     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep6     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep7     .     .     .     .     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep8     .     .     .     .     .     2</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Reduce PSM object to peptides</span></span>
<span class="r-in"><span class="va">rpsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="PSM.html">reducePSMs</a></span><span class="op">(</span><span class="va">psm</span>, k <span class="op">=</span> <span class="va">psm</span><span class="op">$</span><span class="va">peptide</span><span class="op">)</span></span>
<span class="r-in"><span class="va">rpsm</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reduced PSM with 7 rows and 3 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(3): psm peptide protein</span>
<span class="r-in"><span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">rpsm</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 x 6 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ProtA ProtB ProtC ProtD ProtE ProtF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep1     1     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep2     .     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep3     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep4     .     .     .     1     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep6     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep7     .     .     .     .     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep8     .     .     .     .     .     1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Or set binary to TRUE</span></span>
<span class="r-in"><span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">psm</span>, binary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 x 6 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ProtA ProtB ProtC ProtD ProtE ProtF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep1     1     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep2     .     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep3     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep4     .     .     .     1     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep6     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep7     .     .     .     .     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pep8     .     .     .     .     .     1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ----------------------------</span></span>
<span class="r-in"><span class="co">## PSM object from an mzid file</span></span>
<span class="r-in"><span class="co">## ----------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">msdata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/msdata/man/proteomics.html" class="external-link">ident</a></span><span class="op">(</span>full.names <span class="op">=</span> <span class="cn">TRUE</span>, pattern <span class="op">=</span> <span class="st">"TMT"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">psm</span> <span class="op">&lt;-</span> <span class="fu"><a href="PSM.html">PSM</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span> |&gt;</span>
<span class="r-in">       <span class="fu"><a href="filterPSMs.html">filterPsmDecoy</a></span><span class="op">(</span><span class="op">)</span> |&gt;</span>
<span class="r-in">       <span class="fu"><a href="filterPSMs.html">filterPsmRank</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed 2896 decoy hits.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed 155 PSMs with rank &gt; 1.</span>
<span class="r-in"><span class="va">psm</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM with 2751 rows and 35 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(35): sequence spectrumID ... subReplacementResidue subLocation</span>
<span class="r-in"><span class="va">adj</span> <span class="op">&lt;-</span> <span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">psm</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">adj</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2357 1504</span>
<span class="r-in"><span class="va">adj</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 x 4 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   ECA2006 ECA1676 ECA3009 ECA1420</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RQCRTDFLNYLR                            1       .       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ESVALADQVTCVDWRNRKATKK                  .       1       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QRMARTSDKQQSIRFLERLCGR                  .       .       2       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DGGPAIYGHERVGRNAKKFKCLKFR               .       .       .       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CIDRARHVEVQIFGDGKGRVVALGERDCSLQRR       .       .       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VGRCRPIINYLASPGGTSER                    .       .       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QRLDEHCVGVGQNALLLGR                     .       .       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VDYQGKKVVIIGLGLTGLSCVDFFLARGVVPR        .       .       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TLIIERCR                                .       .       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QEVESCTTIEKIWVIDLKIK                    .       .       .       .</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Binary adjacency matrix</span></span>
<span class="r-in"><span class="va">adj</span> <span class="op">&lt;-</span> <span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">psm</span>, binary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">adj</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 x 4 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   ECA2006 ECA1676 ECA3009 ECA1420</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RQCRTDFLNYLR                            1       .       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ESVALADQVTCVDWRNRKATKK                  .       1       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QRMARTSDKQQSIRFLERLCGR                  .       .       1       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DGGPAIYGHERVGRNAKKFKCLKFR               .       .       .       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CIDRARHVEVQIFGDGKGRVVALGERDCSLQRR       .       .       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VGRCRPIINYLASPGGTSER                    .       .       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QRLDEHCVGVGQNALLLGR                     .       .       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VDYQGKKVVIIGLGLTGLSCVDFFLARGVVPR        .       .       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TLIIERCR                                .       .       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QEVESCTTIEKIWVIDLKIK                    .       .       .       .</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Peptides with rowSums &gt; 1 match multiple proteins.</span></span>
<span class="r-in"><span class="co">## Use filterPsmShared() to filter these out.</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">adj</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1    2    3    4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2324   28    3    2 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## -----------------------------------------------</span></span>
<span class="r-in"><span class="co">## Binary, non-binary and score adjacency matrices</span></span>
<span class="r-in"><span class="co">## -----------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## -------------------------------------</span></span>
<span class="r-in"><span class="co">## Case 1: no scores, 1 PSM per peptides</span></span>
<span class="r-in"><span class="va">psmdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>spectrum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp1"</span>, <span class="st">"sp2"</span>, <span class="st">"sp3"</span>, <span class="st">"sp4"</span>, <span class="st">"sp5"</span>,</span>
<span class="r-in">                                 <span class="st">"sp6"</span>, <span class="st">"sp7"</span>, <span class="st">"sp8"</span>, <span class="st">"sp9"</span>, <span class="st">"sp10"</span><span class="op">)</span>,</span>
<span class="r-in">                    sequence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NKAVRTYHEQ"</span>, <span class="st">"IYNHSQGFCA"</span>, <span class="st">"YHWRLPVSEF"</span>,</span>
<span class="r-in">                                 <span class="st">"YEHNGFPLKD"</span>, <span class="st">"WAQFDVYNLS"</span>, <span class="st">"EDHINCTQWP"</span>,</span>
<span class="r-in">                                 <span class="st">"WSMKVDYEQT"</span>, <span class="st">"GWTSKMRYPL"</span>, <span class="st">"PMAYIWEKLC"</span>,</span>
<span class="r-in">                                 <span class="st">"HWAEYFNDVT"</span><span class="op">)</span>,</span>
<span class="r-in">                    protein <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ProtB"</span>, <span class="st">"ProtB"</span>, <span class="st">"ProtA"</span>, <span class="st">"ProtD"</span>, <span class="st">"ProtD"</span>,</span>
<span class="r-in">                                <span class="st">"ProtG"</span>, <span class="st">"ProtF"</span>, <span class="st">"ProtE"</span>, <span class="st">"ProtC"</span>, <span class="st">"ProtF"</span><span class="op">)</span>,</span>
<span class="r-in">                    decoy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">                    rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">                    score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.082</span>, <span class="fl">0.310</span>, <span class="fl">0.133</span>, <span class="fl">0.174</span>, <span class="fl">0.944</span>, <span class="fl">0.0261</span>,</span>
<span class="r-in">                              <span class="fl">0.375</span>, <span class="fl">0.741</span>, <span class="fl">0.254</span>, <span class="fl">0.058</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">psmdf</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    spectrum   sequence protein decoy rank  score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       sp1 NKAVRTYHEQ   ProtB FALSE    1 0.0820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       sp2 IYNHSQGFCA   ProtB FALSE    1 0.3100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       sp3 YHWRLPVSEF   ProtA FALSE    1 0.1330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       sp4 YEHNGFPLKD   ProtD FALSE    1 0.1740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       sp5 WAQFDVYNLS   ProtD FALSE    1 0.9440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       sp6 EDHINCTQWP   ProtG FALSE    1 0.0261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       sp7 WSMKVDYEQT   ProtF FALSE    1 0.3750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       sp8 GWTSKMRYPL   ProtE FALSE    1 0.7410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       sp9 PMAYIWEKLC   ProtC FALSE    1 0.2540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     sp10 HWAEYFNDVT   ProtF FALSE    1 0.0580</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">psm</span> <span class="op">&lt;-</span> <span class="fu"><a href="PSM.html">PSM</a></span><span class="op">(</span><span class="va">psmdf</span>, spectrum <span class="op">=</span> <span class="st">"spectrum"</span>, peptide <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span class="r-in">           protein <span class="op">=</span> <span class="st">"protein"</span>, decoy <span class="op">=</span> <span class="st">"decoy"</span>, rank <span class="op">=</span> <span class="st">"rank"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## binary matrix</span></span>
<span class="r-in"><span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">psm</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 x 7 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ProtB ProtA ProtD ProtG ProtF ProtE ProtC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NKAVRTYHEQ     1     .     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IYNHSQGFCA     1     .     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YHWRLPVSEF     .     1     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEHNGFPLKD     .     .     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WAQFDVYNLS     .     .     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EDHINCTQWP     .     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WSMKVDYEQT     .     .     .     .     1     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GWTSKMRYPL     .     .     .     .     .     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PMAYIWEKLC     .     .     .     .     .     .     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HWAEYFNDVT     .     .     .     .     1     .     .</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Case 2: sp1 and sp11 match the same peptide (NKAVRTYHEQ)</span></span>
<span class="r-in"><span class="va">psmdf2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">psmdf</span>,</span>
<span class="r-in">                <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>spectrum <span class="op">=</span> <span class="st">"sp11"</span>,</span>
<span class="r-in">                           sequence <span class="op">=</span> <span class="va">psmdf</span><span class="op">$</span><span class="va">sequence</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span class="r-in">                           protein <span class="op">=</span> <span class="va">psmdf</span><span class="op">$</span><span class="va">protein</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span class="r-in">                           decoy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">                           rank <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">                           score <span class="op">=</span> <span class="fl">0.011</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">psmdf2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    spectrum   sequence protein decoy rank  score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       sp1 NKAVRTYHEQ   ProtB FALSE    1 0.0820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       sp2 IYNHSQGFCA   ProtB FALSE    1 0.3100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       sp3 YHWRLPVSEF   ProtA FALSE    1 0.1330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       sp4 YEHNGFPLKD   ProtD FALSE    1 0.1740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       sp5 WAQFDVYNLS   ProtD FALSE    1 0.9440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       sp6 EDHINCTQWP   ProtG FALSE    1 0.0261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       sp7 WSMKVDYEQT   ProtF FALSE    1 0.3750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       sp8 GWTSKMRYPL   ProtE FALSE    1 0.7410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       sp9 PMAYIWEKLC   ProtC FALSE    1 0.2540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     sp10 HWAEYFNDVT   ProtF FALSE    1 0.0580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     sp11 NKAVRTYHEQ   ProtB FALSE    1 0.0110</span>
<span class="r-in"><span class="va">psm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="PSM.html">PSM</a></span><span class="op">(</span><span class="va">psmdf2</span>, spectrum <span class="op">=</span> <span class="st">"spectrum"</span>, peptide <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span class="r-in">            protein <span class="op">=</span> <span class="st">"protein"</span>, decoy <span class="op">=</span> <span class="st">"decoy"</span>, rank <span class="op">=</span> <span class="st">"rank"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Now NKAVRTYHEQ/ProtB counts 2 PSMs</span></span>
<span class="r-in"><span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">psm2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 x 7 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ProtB ProtA ProtD ProtG ProtF ProtE ProtC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NKAVRTYHEQ     2     .     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IYNHSQGFCA     1     .     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YHWRLPVSEF     .     1     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEHNGFPLKD     .     .     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WAQFDVYNLS     .     .     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EDHINCTQWP     .     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WSMKVDYEQT     .     .     .     .     1     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GWTSKMRYPL     .     .     .     .     .     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PMAYIWEKLC     .     .     .     .     .     .     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HWAEYFNDVT     .     .     .     .     1     .     .</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Force a binary matrix</span></span>
<span class="r-in"><span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">psm2</span>, binary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 x 7 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ProtB ProtA ProtD ProtG ProtF ProtE ProtC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NKAVRTYHEQ     1     .     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IYNHSQGFCA     1     .     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YHWRLPVSEF     .     1     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEHNGFPLKD     .     .     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WAQFDVYNLS     .     .     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EDHINCTQWP     .     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WSMKVDYEQT     .     .     .     .     1     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GWTSKMRYPL     .     .     .     .     .     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PMAYIWEKLC     .     .     .     .     .     .     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HWAEYFNDVT     .     .     .     .     1     .     .</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## --------------------------------</span></span>
<span class="r-in"><span class="co">## Case 3: set the score PSM values</span></span>
<span class="r-in"><span class="fu"><a href="PSM.html">psmVariables</a></span><span class="op">(</span><span class="va">psm</span><span class="op">)</span> <span class="co">## no score defined</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   spectrum    peptide    protein      decoy       rank      score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "spectrum" "sequence"  "protein"    "decoy"     "rank"         NA </span>
<span class="r-in"><span class="va">psm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="PSM.html">PSM</a></span><span class="op">(</span><span class="va">psm</span>, spectrum <span class="op">=</span> <span class="st">"spectrum"</span>, peptide <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span class="r-in">            protein <span class="op">=</span> <span class="st">"protein"</span>, decoy <span class="op">=</span> <span class="st">"decoy"</span>, rank <span class="op">=</span> <span class="st">"rank"</span>,</span>
<span class="r-in">            score <span class="op">=</span> <span class="st">"score"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="PSM.html">psmVariables</a></span><span class="op">(</span><span class="va">psm3</span><span class="op">)</span> <span class="co">## score defined</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   spectrum    peptide    protein      decoy       rank      score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "spectrum" "sequence"  "protein"    "decoy"     "rank"    "score" </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## adjacency matrix with scores</span></span>
<span class="r-in"><span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">psm3</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 x 7 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ProtB ProtA ProtD  ProtG ProtF ProtE ProtC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NKAVRTYHEQ 0.082 .     .     .      .     .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IYNHSQGFCA 0.310 .     .     .      .     .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YHWRLPVSEF .     0.133 .     .      .     .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEHNGFPLKD .     .     0.174 .      .     .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WAQFDVYNLS .     .     0.944 .      .     .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EDHINCTQWP .     .     .     0.0261 .     .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WSMKVDYEQT .     .     .     .      0.375 .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GWTSKMRYPL .     .     .     .      .     0.741 .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PMAYIWEKLC .     .     .     .      .     .     0.254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HWAEYFNDVT .     .     .     .      0.058 .     .    </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Force a binary matrix</span></span>
<span class="r-in"><span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">psm3</span>, binary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 x 7 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ProtB ProtA ProtD ProtG ProtF ProtE ProtC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NKAVRTYHEQ     1     .     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IYNHSQGFCA     1     .     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YHWRLPVSEF     .     1     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEHNGFPLKD     .     .     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WAQFDVYNLS     .     .     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EDHINCTQWP     .     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WSMKVDYEQT     .     .     .     .     1     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GWTSKMRYPL     .     .     .     .     .     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PMAYIWEKLC     .     .     .     .     .     .     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HWAEYFNDVT     .     .     .     .     1     .     .</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ---------------------------------</span></span>
<span class="r-in"><span class="co">## Case 4: scores with multiple PSMs</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">psm4</span> <span class="op">&lt;-</span> <span class="fu"><a href="PSM.html">PSM</a></span><span class="op">(</span><span class="va">psm2</span>, spectrum <span class="op">=</span> <span class="st">"spectrum"</span>, peptide <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span class="r-in">            protein <span class="op">=</span> <span class="st">"protein"</span>, decoy <span class="op">=</span> <span class="st">"decoy"</span>, rank <span class="op">=</span> <span class="st">"rank"</span>,</span>
<span class="r-in">            score <span class="op">=</span> <span class="st">"score"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Now NKAVRTYHEQ/ProtB has a summed score of 0.093 computed as</span></span>
<span class="r-in"><span class="co">## 0.082 (from sp1) + 0.011 (from sp11)</span></span>
<span class="r-in"><span class="fu">makeAdjacencyMatrix</span><span class="op">(</span><span class="va">psm4</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 x 7 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ProtB ProtA ProtD  ProtG ProtF ProtE ProtC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NKAVRTYHEQ 0.093 .     .     .      .     .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IYNHSQGFCA 0.310 .     .     .      .     .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YHWRLPVSEF .     0.133 .     .      .     .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEHNGFPLKD .     .     0.174 .      .     .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WAQFDVYNLS .     .     0.944 .      .     .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EDHINCTQWP .     .     .     0.0261 .     .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WSMKVDYEQT .     .     .     .      0.375 .     .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GWTSKMRYPL .     .     .     .      .     0.741 .    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PMAYIWEKLC .     .     .     .      .     .     0.254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HWAEYFNDVT .     .     .     .      0.058 .     .    </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

