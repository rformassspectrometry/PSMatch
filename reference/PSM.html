<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>A class for peptide-spectrum matches — PSM • PSMatch</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="A class for peptide-spectrum matches — PSM"><meta property="og:description" content="The PSM class is a simple class to store and manipulate
peptide-spectrum matches. The class encapsulates PSM data as a
DataFrame (or more specifically a DFrame) with additional
lightweight metadata annotation.
There are two types of PSM objects:
Objects with duplicated spectrum identifiers. This holds for
multiple matches to the same spectrum, be it different peptide
sequences or the same sequence with or without a
post-translational modification. Such objects are typically
created with the PSM() constructor starting from mzIdentML
files.
Reduced objects where the spectrum identifiers (or any
equivalent column) are unique keys within the PSM table. Matches
to the same scan/spectrum are merged into a single PSM data
row. Reduced PSM object are created with the reducePSMs()
function. See examples below.


Objects can be checked for their reduced state with the
reduced() function which returns TRUE for reduced instances,
FALSE when the spectrum identifiers are duplicated, or NA when
unknown. The flag can also be set explicitly with the
reduced()&amp;lt;- setter."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PSMatch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/AdjacencyMatrix.html">Understanding protein groups with adjacency matrices</a>
    </li>
    <li>
      <a href="../articles/Fragments.html">MS2 fragment ions</a>
    </li>
    <li>
      <a href="../articles/PSM.html">Working with PSM data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/RforMassSpectrometry/PSM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>A class for peptide-spectrum matches</h1>
    <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/PSM/blob/HEAD/R/PSM-class.R" class="external-link"><code>R/PSM-class.R</code></a>, <a href="https://github.com/RforMassSpectrometry/PSM/blob/HEAD/R/PSM-reduce.R" class="external-link"><code>R/PSM-reduce.R</code></a>, <a href="https://github.com/RforMassSpectrometry/PSM/blob/HEAD/R/adjacencyMatrix-accessors.R" class="external-link"><code>R/adjacencyMatrix-accessors.R</code></a></small>
    <div class="hidden name"><code>PSM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>PSM</code> class is a simple class to store and manipulate
peptide-spectrum matches. The class encapsulates PSM data as a
<code>DataFrame</code> (or more specifically a <code>DFrame</code>) with additional
lightweight metadata annotation.</p>
<p>There are two types of <code>PSM</code> objects:</p><ul><li><p>Objects with duplicated spectrum identifiers. This holds for
multiple matches to the same spectrum, be it different peptide
sequences or the same sequence with or without a
post-translational modification. Such objects are typically
created with the <code>PSM()</code> constructor starting from <code>mzIdentML</code>
files.</p></li>
<li><p>Reduced objects where the spectrum identifiers (or any
equivalent column) are unique keys within the PSM table. Matches
to the same scan/spectrum are merged into a single PSM data
row. Reduced <code>PSM</code> object are created with the <code>reducePSMs()</code>
function. See examples below.</p></li>
</ul><p>Objects can be checked for their reduced state with the
<code>reduced()</code> function which returns <code>TRUE</code> for reduced instances,
<code>FALSE</code> when the spectrum identifiers are duplicated, or NA when
unknown. The flag can also be set explicitly with the
<code>reduced()&lt;-</code> setter.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">PSM</span><span class="op">(</span>
  <span class="va">x</span>,
  spectrum <span class="op">=</span> <span class="cn">NA</span>,
  peptide <span class="op">=</span> <span class="cn">NA</span>,
  protein <span class="op">=</span> <span class="cn">NA</span>,
  decoy <span class="op">=</span> <span class="cn">NA</span>,
  rank <span class="op">=</span> <span class="cn">NA</span>,
  score <span class="op">=</span> <span class="cn">NA</span>,
  parser <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mzR"</span>, <span class="st">"mzID"</span><span class="op">)</span>,
  BPPARAM <span class="op">=</span> <span class="fu">SerialParam</span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">reduced</span><span class="op">(</span><span class="va">object</span>, spectrum <span class="op">=</span> <span class="fu">psmVariables</span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">[</span><span class="st">"spectrum"</span><span class="op">]</span><span class="op">)</span>

<span class="fu">reduced</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="fu">psmVariables</span><span class="op">(</span><span class="va">object</span>, which <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>

<span class="fu">reducePSMs</span><span class="op">(</span><span class="va">object</span>, k <span class="op">=</span> <span class="va">object</span><span class="op">[[</span><span class="fu">psmVariables</span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">[</span><span class="st">"spectrum"</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>

<span class="co"># S4 method for PSM</span>
<span class="fu"><a href="adjacencyMatrix.html">adjacencyMatrix</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p><code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> of mzid file names, an instance of class
<code>PSM</code>, or a <code>data.frame</code>.</p></dd>
<dt>spectrum</dt>
<dd><p><code>character(1)</code> variable name that defines a
spectrum in the PSM data. Default are <code>"spectrumID"</code> (mzR
parser) or <code>"spectrumid"</code> (mzID parser). It is also used to
calculate the reduced state.</p></dd>
<dt>peptide</dt>
<dd><p><code>character(1)</code> variable name that defines a peptide
in the PSM data. Detaults are <code>"spequence"</code> (mzR parser) or
<code>"pepSeq"</code> (mzID parser).</p></dd>
<dt>protein</dt>
<dd><p><code>character(1)</code> variable name that defines a protein
in the PSM data. Detaults are <code>"DatabaseAccess"</code> (mzR parser)
or <code>"accession"</code> (mzID parser).</p></dd>
<dt>decoy</dt>
<dd><p><code>character(1)</code> variable name that defines a decoy hit
in the PSM data. Detaults are <code>"isDecoy"</code> (mzR parser) or
<code>"isdecoy"</code> (mzID parser).</p></dd>
<dt>rank</dt>
<dd><p><code>character(1)</code> variable name that defines the rank of
the peptide spectrum match in the PSM data. Default is <code>"rank"</code>.</p></dd>
<dt>score</dt>
<dd><p><code>character(1)</code> variable name that defines the PSM
score. This value isn't set by default as it depends on the
search engine and application. Default is <code>NA</code>.</p></dd>
<dt>parser</dt>
<dd><p><code>character(1)</code> defining the parser to be used to
read the <code>mzIdentML</code> files. One of <code>"mzR"</code> (default) or
<code>"mzID"</code>.</p></dd>
<dt>BPPARAM</dt>
<dd><p>an object inheriting from BiocParallelParam to
control parallel processing. The default value is
<code>SerialParam()</code> to read files in series.</p></dd>
<dt>object</dt>
<dd><p>An instance of class <code>PSM</code>.</p></dd>
<dt>value</dt>
<dd><p>new value to be passed to setter.</p></dd>
<dt>which</dt>
<dd><p><code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> with the PSM variable name to
retrieve. If <code>"all"</code> (default), all named variables are
returned. See <code>PSM()</code> for valid PSM variables.</p></dd>
<dt>k</dt>
<dd><p>A <code>vector</code> or <code>factor</code> of length equal to <code>nrow(x)</code> that
defines the primary key used to reduce <code>x</code>. This typically
corresponds to the spectrum identifier. The defauls is to use
the spectrum PSM variable.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>PSM()</code> returns a <code>PSM</code> object.
<code>reducePSMs()</code> returns a reduced version of the <code>x</code> input.</p>
    </div>
    <div id="creating-and-using-psm-objects">
    <h2>Creating and using PSM objects</h2>
    

<ul><li><p>The <code>PSM()</code> constructor uses parsers provided by the <code>mzR</code> or
<code>mzID</code> packages to read the <code>mzIdentML</code> data. The vignette
describes some apparent differences in their outputs. The
constructor input is a character of one more multiple file
names.</p></li>
<li><p><code>PSM</code> objects can also be created from a <code>data.frame</code> object (or
any variable that can be coerced into a DataFrame.</p></li>
<li><p>Finally, <code>PSM()</code> can also take a <code>PSM</code> object as input, which
leaves the PSM data as is and is used to set/update the PSM
variables.</p></li>
<li><p>The constructor can also initialise variables (called <em>PSM
variables</em>) needed for downstream processing, notably filtering
(see <code><a href="filterPSMs.html">filterPSMs()</a></code>) and to generate a peptide-by-protein
adjacency matrix (see <code><a href="adjacencyMatrix.html">makeAdjacencyMatrix()</a></code>). These variables
can be extracted with the <code>psmVariables()</code> function. They
represent the columns in the PSM table that identify spectra,
peptides, proteins, decoy peptides hit ranks and, optionally, a
PSM score. The value of these variables will depend on the
backend used to create the object, or left blank (i.e. encoded
as <code>NA</code>) when building an object by hand from a <code>data.frame</code>. In
such situation, they need to be passed explicitly by the user as
arguments to <code>PSM()</code>.</p></li>
<li><p>The <code><a href="adjacencyMatrix.html">adjacencyMatrix()</a></code> accessor can be used to retrieve the
binary sparse peptide-by-protein adjacency matrix from the PSM
object. It also relies on PSM variables which thus need to be
set beforehand. For more flexibility in the generation of the
adjacency matrix (for non-binary matrices), use
<code><a href="adjacencyMatrix.html">makeAdjacencyMatrix()</a></code>.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## ---------------------------------</span></span>
<span class="r-in"><span class="co">## Example with a single mzid file</span></span>
<span class="r-in"><span class="co">## ---------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">msdata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/msdata/man/proteomics.html" class="external-link">ident</a></span><span class="op">(</span>full.names <span class="op">=</span> <span class="cn">TRUE</span>, pattern <span class="op">=</span> <span class="st">"TMT"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzid"</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## mzR parser (default)</span></span>
<span class="r-in"><span class="va">psm</span> <span class="op">&lt;-</span> <span class="fu">PSM</span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span class="r-in"><span class="va">psm</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM with 5802 rows and 35 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(35): sequence spectrumID ... subReplacementResidue subLocation</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## PSM variables</span></span>
<span class="r-in"><span class="fu">psmVariables</span><span class="op">(</span><span class="va">psm</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         spectrum          peptide          protein            decoy </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     "spectrumID"       "sequence" "DatabaseAccess"        "isDecoy" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             rank            score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           "rank"               NA </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## mzID parser</span></span>
<span class="r-in"><span class="va">psm_mzid</span> <span class="op">&lt;-</span> <span class="fu">PSM</span><span class="op">(</span><span class="va">f</span>, parser <span class="op">=</span> <span class="st">"mzID"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: mzID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reading TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzid...</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  DONE!</span>
<span class="r-in"><span class="va">psm_mzid</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM with 5759 rows and 30 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(30): spectrumid scan number(s) ... spectrumFile databaseFile</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## different PSM variables</span></span>
<span class="r-in"><span class="fu">psmVariables</span><span class="op">(</span><span class="va">psm_mzid</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     spectrum      peptide      protein        decoy         rank        score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "spectrumid"     "pepseq"  "accession"    "isdecoy"       "rank"           NA </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Reducing the PSM data</span></span>
<span class="r-in"><span class="op">(</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">psm</span><span class="op">$</span><span class="va">spectrumID</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  9 24</span>
<span class="r-in"><span class="op">(</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">psm</span><span class="op">$</span><span class="va">spectrumID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">psm</span><span class="op">$</span><span class="va">spectrumID</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  8  9 23 24 25 26</span>
<span class="r-in"><span class="va">psm2</span> <span class="op">&lt;-</span> <span class="va">psm</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span class="r-in"><span class="fu">reduced</span><span class="op">(</span><span class="va">psm2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Peptide sequence CIDRARHVEVQIFGDGKGRVVALGERDCSLQRR with</span></span>
<span class="r-in"><span class="co">## Carbamidomethyl modifications at positions 1 and 28.</span></span>
<span class="r-in"><span class="fu">DataFrame</span><span class="op">(</span><span class="va">psm2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sequence"</span>, <span class="st">"spectrumID"</span>, <span class="st">"modName"</span>, <span class="st">"modLocation"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 6 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        sequence    spectrumID       modName modLocation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt;   &lt;character&gt;   &lt;character&gt;   &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 CIDRARHVEV... controller... Carbamidom...           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 CIDRARHVEV... controller... Carbamidom...          28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 KCNQCLKVAC... controller... Carbamidom...           2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 KCNQCLKVAC... controller... Carbamidom...           5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 KCNQCLKVAC... controller... Carbamidom...          10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 KCNQCLKVAC... controller... Carbamidom...          15</span>
<span class="r-in"><span class="fu">reduced</span><span class="op">(</span><span class="va">psm2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span class="r-in"><span class="fu">reduced</span><span class="op">(</span><span class="va">psm2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## uses by default the spectrum PSM variable, as defined during</span></span>
<span class="r-in"><span class="co">## the construction - see psmVariables()</span></span>
<span class="r-in"><span class="va">rpsm2</span> <span class="op">&lt;-</span> <span class="fu">reducePSMs</span><span class="op">(</span><span class="va">psm2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">rpsm2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reduced PSM with 2 rows and 35 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(35): sequence spectrumID ... subReplacementResidue subLocation</span>
<span class="r-in"><span class="fu">DataFrame</span><span class="op">(</span><span class="va">rpsm2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sequence"</span>, <span class="st">"spectrumID"</span>, <span class="st">"modName"</span>, <span class="st">"modLocation"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 2 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                    sequence    spectrumID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                 &lt;character&gt;   &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> controllerType=0 controllerNumber=1 scan=5490 KCNQCLKVAC... controller...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> controllerType=0 controllerNumber=1 scan=6518 CIDRARHVEV... controller...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                     modName   modLocation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                 &lt;character&gt; &lt;IntegerList&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> controllerType=0 controllerNumber=1 scan=5490 Carbamidom...    2,5,10,...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> controllerType=0 controllerNumber=1 scan=6518 Carbamidom...          1,28</span>
<span class="r-in"><span class="fu">reduced</span><span class="op">(</span><span class="va">rpsm2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ---------------------------------</span></span>
<span class="r-in"><span class="co">## Multiple mzid files</span></span>
<span class="r-in"><span class="co">## ---------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lgatto/rpx" class="external-link">rpx</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">PXD022816</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset2.html" class="external-link">PXDataset</a></span><span class="op">(</span><span class="st">"PXD022816"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading PXD022816 from cache.</span>
<span class="r-in"><span class="va">PXD022816</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Project PXD022816 with 31 files</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Resource ID BFC1 in cache in /github/home/.cache/R/rpx.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 'checksum.txt' ... [31] 'QEP2LC6_HeLa_50ng_251120_10-calib.mzML'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Use 'pxfiles(.)' to see all files.</span>
<span class="r-in"></span>
<span class="r-in"><span class="op">(</span><span class="va">mzids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset2.html" class="external-link">pxget</a></span><span class="op">(</span><span class="va">PXD022816</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"mzID"</span>, <span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset2.html" class="external-link">pxfiles</a></span><span class="op">(</span><span class="va">PXD022816</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Project PXD022816 files (31):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] checksum.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_01.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_02.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_03.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_04.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_05.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_06.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_07.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_08.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_09.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading QEP2LC6_HeLa_50ng_251120_01-calib.mzID.gz from cache.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading QEP2LC6_HeLa_50ng_251120_02-calib.mzID.gz from cache.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/github/home/.cache/R/rpx/9951f2d83e8_QEP2LC6_HeLa_50ng_251120_01-calib.mzID.gz"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "/github/home/.cache/R/rpx/9955013aeab_QEP2LC6_HeLa_50ng_251120_02-calib.mzID.gz"</span>
<span class="r-in"><span class="va">psm</span> <span class="op">&lt;-</span> <span class="fu">PSM</span><span class="op">(</span><span class="va">mzids</span><span class="op">)</span></span>
<span class="r-in"><span class="va">psm</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM with 50314 rows and 31 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(31): sequence spectrumID ... subReplacementResidue subLocation</span>
<span class="r-in"><span class="fu">psmVariables</span><span class="op">(</span><span class="va">psm</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         spectrum          peptide          protein            decoy </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     "spectrumID"       "sequence" "DatabaseAccess"        "isDecoy" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             rank            score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           "rank"               NA </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Here, spectrum identifiers are repeated accross files</span></span>
<span class="r-in"><span class="va">psm</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"scan=20000"</span>, <span class="va">psm</span><span class="op">$</span><span class="va">spectrumID</span><span class="op">)</span>, <span class="st">"spectrumFile"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "P:\\Projects\\Morgenstern\\HF2_QC_for_the_paper\\QEP2\\2020-11-29-13-56-12\\Task1-CalibrateTask\\QEP2LC6_HeLa_50ng_251120_01-calib.mzML"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "P:\\Projects\\Morgenstern\\HF2_QC_for_the_paper\\QEP2\\2020-11-29-13-56-12\\Task1-CalibrateTask\\QEP2LC6_HeLa_50ng_251120_02-calib.mzML"</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Let's create a new primary identifier composed of the scan</span></span>
<span class="r-in"><span class="co">## number and the file name</span></span>
<span class="r-in"><span class="va">psm</span><span class="op">$</span><span class="va">pkey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^.+Task\\\\"</span>, <span class="st">""</span>, <span class="va">psm</span><span class="op">$</span><span class="va">spectrumFile</span><span class="op">)</span>,</span>
<span class="r-in">                  <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^.+scan="</span>, <span class="st">""</span>, <span class="va">psm</span><span class="op">$</span><span class="va">spectrumID</span><span class="op">)</span>,</span>
<span class="r-in">                  sep <span class="op">=</span> <span class="st">"::"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">psm</span><span class="op">$</span><span class="va">pkey</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::3426" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::20165"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::20180"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::15180"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::10327"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::12894"</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## the PSM is not reduced</span></span>
<span class="r-in"><span class="fu">reduced</span><span class="op">(</span><span class="va">psm</span>, <span class="st">"pkey"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span class="fu">DataFrame</span><span class="op">(</span><span class="va">psm</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">7</span>, <span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 2 rows and 32 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        sequence    spectrumID chargeState      rank passThreshold</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt;   &lt;character&gt;   &lt;integer&gt; &lt;integer&gt;     &lt;logical&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 SEGSSCALES... controller...           4         1          TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 SEGSSCALES... controller...           4         1          TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   experimentalMassToCharge calculatedMassToCharge  peptideRef    modNum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  &lt;numeric&gt;              &lt;numeric&gt; &lt;character&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                  796.367                796.367        P_19         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                  796.367                796.367        P_19         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     isDecoy        post         pre     start       end DatabaseAccess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;logical&gt; &lt;character&gt; &lt;character&gt; &lt;integer&gt; &lt;integer&gt;    &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     FALSE           I           K       220       251         Q58D62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     FALSE           I           K       220       251         Q58D62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DBseqLength   DatabaseSeq DatabaseDescription scan.start.time acquisitionNum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;integer&gt;   &lt;character&gt;         &lt;character&gt;     &lt;character&gt;      &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         387 MNVLLLLVLC...       Q58D62|FET...       32.788864          12894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         387 MNVLLLLVLC...       Q58D62|FET...       32.788864          12894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     spectrumFile        idFile MetaMorpheus.score PSM.level.q.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;character&gt;   &lt;character&gt;          &lt;numeric&gt;         &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 P:\\Project... 9951f2d83e...            31.2586                 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 P:\\Project... 9951f2d83e...            31.2586                 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   modPeptideRef       modName   modMass modLocation subOriginalResidue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt;   &lt;character&gt; &lt;numeric&gt;   &lt;integer&gt;        &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          P_19 Carbamidom...   57.0215           6                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          P_19 Carbamidom...   57.0215          19                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   subReplacementResidue subLocation          pkey</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &lt;character&gt;   &lt;integer&gt;   &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                    NA          NA QEP2LC6_He...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                    NA          NA QEP2LC6_He...</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## same sequence, same spectrumID, same file</span></span>
<span class="r-in"><span class="va">psm</span><span class="op">$</span><span class="va">sequence</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "SEGSSCALESPGSVPVGICHGSLGEPQGNQGK" "SEGSSCALESPGSVPVGICHGSLGEPQGNQGK"</span>
<span class="r-in"><span class="va">psm</span><span class="op">$</span><span class="va">pkey</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::12894"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::12894"</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## different modification locations</span></span>
<span class="r-in"><span class="va">psm</span><span class="op">$</span><span class="va">modLocation</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  6 19</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## here, we need to *explicitly* set pkey to reduce</span></span>
<span class="r-in"><span class="va">rpsm</span> <span class="op">&lt;-</span> <span class="fu">reducePSMs</span><span class="op">(</span><span class="va">psm</span>, <span class="va">psm</span><span class="op">$</span><span class="va">pkey</span><span class="op">)</span></span>
<span class="r-in"><span class="va">rpsm</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reduced PSM with 32739 rows and 32 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(32): sequence spectrumID ... subLocation pkey</span>
<span class="r-in"><span class="fu">reduced</span><span class="op">(</span><span class="va">rpsm</span>, <span class="st">"pkey"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## the two rows are now merged into a single one; the distinct</span></span>
<span class="r-in"><span class="co">## modification locations are preserved.</span></span>
<span class="r-in"><span class="op">(</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">rpsm</span><span class="op">$</span><span class="va">pkey</span> <span class="op">==</span> <span class="st">"QEP2LC6_HeLa_50ng_251120_01-calib.mzML::12894"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2343</span>
<span class="r-in"><span class="fu">DataFrame</span><span class="op">(</span><span class="va">rpsm</span><span class="op">[</span><span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sequence"</span>, <span class="st">"pkey"</span>, <span class="st">"modName"</span>, <span class="st">"modLocation"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 1 row and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                      sequence          pkey</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                               &lt;CharacterList&gt;   &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QEP2LC6_HeLa_50ng_251120_01-calib.mzML::12894   SEGSSCALES... QEP2LC6_He...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                       modName   modLocation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                               &lt;CharacterList&gt; &lt;IntegerList&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QEP2LC6_HeLa_50ng_251120_01-calib.mzML::12894   Carbamidom...          6,19</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ---------------------------------</span></span>
<span class="r-in"><span class="co">## PSM from a data.frame</span></span>
<span class="r-in"><span class="co">## ---------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">psmdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>spectrum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">                    sequence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">10</span>,</span>
<span class="r-in">                                         <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="getAminoAcids.html">getAminoAcids</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="st">"AA"</span><span class="op">]</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">                                               collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">                    protein <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Prot"</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span>, <span class="fl">10</span>,</span>
<span class="r-in">                                     replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span class="r-in">                    decoy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">                    rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">                    score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">psmdf</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    spectrum   sequence protein decoy rank      score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       sp1 MCARQHEDVK   ProtA FALSE    1 0.53891397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       sp2 SCMWYNFVGP   ProtE FALSE    1 0.49462538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       sp3 YFSHRQLWCA   ProtD FALSE    1 0.26284970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       sp4 VKFIGMWTCA   ProtF FALSE    1 0.20883129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       sp5 DCKFARTMVI   ProtC FALSE    1 0.80546819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       sp6 HFMAGRTPNK   ProtB FALSE    1 0.04962141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       sp7 EHMWRGPQTD   ProtD FALSE    1 0.47843199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       sp8 KYCGHAIQPD   ProtD FALSE    1 0.12732115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       sp9 HLQARDSCEK   ProtF FALSE    1 0.38793878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     sp10 SYKELRCWQT   ProtB FALSE    1 0.53497995</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">psm</span> <span class="op">&lt;-</span> <span class="fu">PSM</span><span class="op">(</span><span class="va">psmdf</span><span class="op">)</span></span>
<span class="r-in"><span class="va">psm</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM with 10 rows and 6 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(6): spectrum sequence ... rank score</span>
<span class="r-in"><span class="fu">psmVariables</span><span class="op">(</span><span class="va">psm</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spectrum  peptide  protein    decoy     rank    score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       NA       NA       NA       NA       NA       NA </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## no PSM variables set</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="adjacencyMatrix.html">adjacencyMatrix</a></span><span class="op">(</span><span class="va">psm</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in .local(object, ...) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Please define the 'protein' and 'peptide' PSM variables.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## set PSM variables</span></span>
<span class="r-in"><span class="va">psm</span> <span class="op">&lt;-</span> <span class="fu">PSM</span><span class="op">(</span><span class="va">psm</span>, spectrum <span class="op">=</span> <span class="st">"spectrum"</span>, peptide <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span class="r-in">           protein <span class="op">=</span> <span class="st">"protein"</span>, decoy <span class="op">=</span> <span class="st">"decoy"</span>, rank <span class="op">=</span> <span class="st">"rank"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">psm</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM with 10 rows and 6 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(6): spectrum sequence ... rank score</span>
<span class="r-in"><span class="fu">psmVariables</span><span class="op">(</span><span class="va">psm</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   spectrum    peptide    protein      decoy       rank      score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "spectrum" "sequence"  "protein"    "decoy"     "rank"         NA </span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="adjacencyMatrix.html">adjacencyMatrix</a></span><span class="op">(</span><span class="va">psm</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 x 6 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ProtA ProtE ProtD ProtF ProtC ProtB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MCARQHEDVK     1     .     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SCMWYNFVGP     .     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YFSHRQLWCA     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VKFIGMWTCA     .     .     .     1     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DCKFARTMVI     .     .     .     .     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HFMAGRTPNK     .     .     .     .     .     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EHMWRGPQTD     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KYCGHAIQPD     .     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HLQARDSCEK     .     .     .     1     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SYKELRCWQT     .     .     .     .     .     1</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

