<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>A class for peptide-spectrum matches — PSM • PSMatch</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="A class for peptide-spectrum matches — PSM"><meta property="og:description" content="The PSM class is a simple class to store and manipulate
peptide-spectrum matches. The class encapsulates PSM data as a
DataFrame (or more specifically a DFrame) with additional
lightweight metadata annotation.
There are two types of PSM objects:
Objects with duplicated spectrum identifiers. This holds for
multiple matches to the same spectrum, be it different peptide
sequences or the same sequence with or without a
post-translational modification. Such objects are typically
created with the PSM() constructor starting from mzIdentML
files.
Reduced object where the spectrum identifiers (or any equivalent
column - see example below) are unique keys within the PSM
table. Matches to the same scan/spectrum in each raw data file
are merged into a single data row. Reduced PSM object are
created with the reducePSMs() function. See examples below.


Objects can be checked for their reduced state with the
reduced() function which returns TRUE for reduced instances,
FALSE when the spectrum identifiers are duplicated, or NA when
unknown. The flag can also be set explicitly with the
reduced()&amp;lt;- setter.
The constructor uses parsers provided by the mzR or mzID
packages to read the mzIdentML data. See the vignette for some
apparent differences in their outputs."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PSMatch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/PSMatch.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/RforMassSpectrometry/PSM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>A class for peptide-spectrum matches</h1>
    <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/PSM/blob/master/R/PSM-class.R" class="external-link"><code>R/PSM-class.R</code></a>, <a href="https://github.com/RforMassSpectrometry/PSM/blob/master/R/reducePSMs.R" class="external-link"><code>R/reducePSMs.R</code></a></small>
    <div class="hidden name"><code>PSM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>PSM</code> class is a simple class to store and manipulate
peptide-spectrum matches. The class encapsulates PSM data as a
<code>DataFrame</code> (or more specifically a <code>DFrame</code>) with additional
lightweight metadata annotation.</p>
<p>There are two types of <code>PSM</code> objects:</p><ul><li><p>Objects with duplicated spectrum identifiers. This holds for
multiple matches to the same spectrum, be it different peptide
sequences or the same sequence with or without a
post-translational modification. Such objects are typically
created with the <code>PSM()</code> constructor starting from <code>mzIdentML</code>
files.</p></li>
<li><p>Reduced object where the spectrum identifiers (or any equivalent
column - see example below) are unique keys within the PSM
table. Matches to the same scan/spectrum in each raw data file
are merged into a single data row. Reduced <code>PSM</code> object are
created with the <code>reducePSMs()</code> function. See examples below.</p></li>
</ul><p>Objects can be checked for their reduced state with the
<code>reduced()</code> function which returns TRUE for reduced instances,
FALSE when the spectrum identifiers are duplicated, or NA when
unknown. The flag can also be set explicitly with the
<code>reduced()&lt;-</code> setter.</p>
<p>The constructor uses parsers provided by the <code>mzR</code> or <code>mzID</code>
packages to read the <code>mzIdentML</code> data. See the vignette for some
apparent differences in their outputs.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="fu">PSM</span><span class="op">(</span>
  <span class="va">x</span>,
  spectrum <span class="op">=</span> <span class="cn">NA</span>,
  peptide <span class="op">=</span> <span class="cn">NA</span>,
  protein <span class="op">=</span> <span class="cn">NA</span>,
  decoy <span class="op">=</span> <span class="st">"isDecoy"</span>,
  rank <span class="op">=</span> <span class="st">"rank"</span>,
  parser <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mzR"</span>, <span class="st">"mzID"</span><span class="op">)</span>,
  BPPARAM <span class="op">=</span> <span class="fu">SerialParam</span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">reduced</span><span class="op">(</span><span class="va">x</span>, <span class="va">spectrumID</span><span class="op">)</span>

<span class="fu">reduced</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="fu">reducePSMs</span><span class="op">(</span><span class="va">x</span>, <span class="va">k</span><span class="op">)</span></code></pre></div>

    <div id="ref-sections">
    <div id="arguments">
    <h2>Arguments</h2>
    

<dl><dt>x</dt><dd><p>An instance of class <code>PSM</code>.</p></dd>
</dl><dl><dt>spectrum</dt><dd><p><code>character(1)</code> that defines a spectrum in the PSM
data. Typically <code>"spectrumID"</code>.</p></dd>
</dl><dl><dt>peptide</dt><dd><p><code>character(1)</code> that defines a peptide in the PSM
data. Typically <code>"spequence"</code>.</p></dd>
</dl><dl><dt>protein</dt><dd><p><code>character(1)</code> that defines a protein in the PSM
data. Typically <code>"DatabaseAccess"</code>.</p></dd>
</dl><dl><dt>decoy</dt><dd><p><code>character(1)</code> that defines a decoy hit in the PSM
data. Default is <code>"isDecoy"</code>. This variable is named
<code>"isdecoy"</code> if you use the <code>mzID</code> parser.</p></dd>
</dl><dl><dt>rank</dt><dd><p><code>character(1)</code> that defines the rank of the petide
spetrum match in the PSM data. Default is <code>"rank"</code>.</p></dd>
</dl><dl><dt>parser</dt><dd><p><code>character(1)</code> defining the parser to be used to
read the <code>mzIdentML</code> files. One of <code>"mzR"</code> (default) or
<code>"mzID"</code>.</p></dd>
</dl><dl><dt>BPPARAM</dt><dd><p>an object inheriting from BiocParallelParam to
control parallel processing. The default value is
<code>SerialParam()</code> to read files in series.</p></dd>
</dl><dl><dt>spectrumID</dt><dd><p><code>character(1)</code> with the column name referring to
the spectrum identifier or any other unique key for the <code>PSM</code>
object <code>x</code>. This parameter can be set to calculate the reduced
state explicitly by by-passing the <code>reduced</code> metadata flag.</p></dd>
</dl><dl><dt>value</dt><dd><p><code>logical(1)</code> to set the reduced state of the <code>PSM</code>
object.</p></dd>
</dl><dl><dt>k</dt><dd><p>A <code>vector</code> or <code>factor</code> of length equal to <code>nrow(x)</code> that
defines the primary key used to reduce <code>x</code>. This typically
corresponds to the spectrum identifier, often names
<code>spectrumID</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>PSM()</code> returns a <code>PSM</code> object containing the
peptide-spectrum matches stored in <code>files</code>.</p>
<p><code>reducePSMs()</code> returns a reduced version of the <code>x</code> input.</p>
    </div>
    </div>

    <div id="examples">
    <h2>Examples</h2>
    <div class="ref-examples sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## ---------------------------------</span></span>
<span class="r-in"><span class="co">## Example with a single mzid file</span></span>
<span class="r-in"><span class="co">## ---------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">msdata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/msdata/man/proteomics.html" class="external-link">ident</a></span><span class="op">(</span>full.names <span class="op">=</span> <span class="cn">TRUE</span>, pattern <span class="op">=</span> <span class="st">"TMT"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzid"</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## mzR parser (default)</span></span>
<span class="r-in"><span class="va">psm</span> <span class="op">&lt;-</span> <span class="fu">PSM</span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: mzR</span>
<span class="r-in"><span class="va">psm</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM with 5802 rows and 35 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(35): sequence spectrumID ... subReplacementResidue subLocation</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## mzID parser</span></span>
<span class="r-in"><span class="fu">PSM</span><span class="op">(</span><span class="va">f</span>, parser <span class="op">=</span> <span class="st">"mzID"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: mzID</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> reading TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzid... DONE!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM with 5759 rows and 30 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(30): spectrumid scan number(s) ... spectrumFile databaseFile</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">psm</span><span class="op">$</span><span class="va">spectrumID</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span class="r-in"><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">psm</span><span class="op">$</span><span class="va">spectrumID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">psm</span><span class="op">$</span><span class="va">spectrumID</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="va">psm2</span> <span class="op">&lt;-</span> <span class="va">psm</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span class="r-in"><span class="fu">reduced</span><span class="op">(</span><span class="va">psm2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Peptide sequence CIDRARHVEVQIFGDGKGRVVALGERDCSLQRR with</span></span>
<span class="r-in"><span class="co">## Carbamidomethyl modifications at positions 1 and 28.</span></span>
<span class="r-in"><span class="fu">DataFrame</span><span class="op">(</span><span class="va">psm2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sequence"</span>, <span class="st">"spectrumID"</span>, <span class="st">"modName"</span>, <span class="st">"modLocation"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 6 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 sequence             spectrumID         modName modLocation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              &lt;character&gt;            &lt;character&gt;     &lt;character&gt;   &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 CIDRARHVEVQIFGDGKGRV.. controllerType=0 con.. Carbamidomethyl           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 CIDRARHVEVQIFGDGKGRV.. controllerType=0 con.. Carbamidomethyl          28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       KCNQCLKVACTLFYCK controllerType=0 con.. Carbamidomethyl           2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       KCNQCLKVACTLFYCK controllerType=0 con.. Carbamidomethyl           5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       KCNQCLKVACTLFYCK controllerType=0 con.. Carbamidomethyl          10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       KCNQCLKVACTLFYCK controllerType=0 con.. Carbamidomethyl          15</span>
<span class="r-in"><span class="fu">reduced</span><span class="op">(</span><span class="va">psm2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">rpsm2</span> <span class="op">&lt;-</span> <span class="fu">reducePSMs</span><span class="op">(</span><span class="va">psm2</span>, <span class="va">psm2</span><span class="op">$</span><span class="va">spectrumID</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The dim() method for DataFrameList objects is deprecated. Please use</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   dims() on these objects instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The nrow() method for DataFrameList objects is deprecated. Please use</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   nrows() on these objects instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The ncol() method for CompressedSplitDataFrameList objects is</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   deprecated. Please use ncols() on these objects instead.</span>
<span class="r-in"><span class="va">rpsm2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reduced PSM with 2 rows and 35 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(35): sequence spectrumID ... subReplacementResidue subLocation</span>
<span class="r-in"><span class="fu">DataFrame</span><span class="op">(</span><span class="va">rpsm2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sequence"</span>, <span class="st">"spectrumID"</span>, <span class="st">"modName"</span>, <span class="st">"modLocation"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 2 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                    sequence    spectrumID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                 &lt;character&gt;   &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> controllerType=0 controllerNumber=1 scan=5490 KCNQCLKVAC... controller...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> controllerType=0 controllerNumber=1 scan=6518 CIDRARHVEV... controller...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                     modName   modLocation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                 &lt;character&gt; &lt;IntegerList&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> controllerType=0 controllerNumber=1 scan=5490 Carbamidom...    2,5,10,...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> controllerType=0 controllerNumber=1 scan=6518 Carbamidom...          1,28</span>
<span class="r-in"><span class="fu">reduced</span><span class="op">(</span><span class="va">rpsm2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ---------------------------------</span></span>
<span class="r-in"><span class="co">## Multiple mzid files</span></span>
<span class="r-in"><span class="co">## ---------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lgatto/rpx" class="external-link">rpx</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">PXD022816</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset2.html" class="external-link">PXDataset</a></span><span class="op">(</span><span class="st">"PXD022816"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading PXD022816 from cache.</span>
<span class="r-in"><span class="va">PXD022816</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Project PXD022816 with 31 files</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Resource ID BFC1 in cache in /github/home/.cache/R/rpx.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 'checksum.txt' ... [31] 'QEP2LC6_HeLa_50ng_251120_10-calib.mzML'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Use 'pxfiles(.)' to see all files.</span>
<span class="r-in"></span>
<span class="r-in"><span class="op">(</span><span class="va">mzids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset2.html" class="external-link">pxget</a></span><span class="op">(</span><span class="va">PXD022816</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"mzID"</span>, <span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset2.html" class="external-link">pxfiles</a></span><span class="op">(</span><span class="va">PXD022816</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Project PXD022816 files (31):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] checksum.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_01.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_02.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_03.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_04.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_05.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_06.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_07.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_08.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [remote] QEP2LC6_HeLa_50ng_251120_09.raw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading QEP2LC6_HeLa_50ng_251120_01-calib.mzID.gz from cache.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading QEP2LC6_HeLa_50ng_251120_02-calib.mzID.gz from cache.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/github/home/.cache/R/rpx/cd13f466667_QEP2LC6_HeLa_50ng_251120_01-calib.mzID.gz"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "/github/home/.cache/R/rpx/cd1203f97a6_QEP2LC6_HeLa_50ng_251120_02-calib.mzID.gz"</span>
<span class="r-in"><span class="va">psm</span> <span class="op">&lt;-</span> <span class="fu">PSM</span><span class="op">(</span><span class="va">mzids</span><span class="op">)</span></span>
<span class="r-in"><span class="va">psm</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM with 50314 rows and 31 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(31): sequence spectrumID ... subReplacementResidue subLocation</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Here, spectrum identifiers are repeated accross files</span></span>
<span class="r-in"><span class="va">psm</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"scan=20000"</span>, <span class="va">psm</span><span class="op">$</span><span class="va">spectrumID</span><span class="op">)</span>, <span class="st">"spectrumFile"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "P:\\Projects\\Morgenstern\\HF2_QC_for_the_paper\\QEP2\\2020-11-29-13-56-12\\Task1-CalibrateTask\\QEP2LC6_HeLa_50ng_251120_01-calib.mzML"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "P:\\Projects\\Morgenstern\\HF2_QC_for_the_paper\\QEP2\\2020-11-29-13-56-12\\Task1-CalibrateTask\\QEP2LC6_HeLa_50ng_251120_02-calib.mzML"</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Let's create a new primary identifier composed of the scan</span></span>
<span class="r-in"><span class="co">## number and the file name</span></span>
<span class="r-in"><span class="va">psm</span><span class="op">$</span><span class="va">pkey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^.+Task\\\\"</span>, <span class="st">""</span>, <span class="va">psm</span><span class="op">$</span><span class="va">spectrumFile</span><span class="op">)</span>,</span>
<span class="r-in">                  <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^.+scan="</span>, <span class="st">""</span>, <span class="va">psm</span><span class="op">$</span><span class="va">spectrumID</span><span class="op">)</span>,</span>
<span class="r-in">                  sep <span class="op">=</span> <span class="st">"::"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">psm</span><span class="op">$</span><span class="va">pkey</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::3426" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::20165"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::20180"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::15180"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::10327"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::12894"</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## the PSM is not reduced</span></span>
<span class="r-in"><span class="fu">reduced</span><span class="op">(</span><span class="va">psm</span>, <span class="st">"pkey"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span class="fu">DataFrame</span><span class="op">(</span><span class="va">psm</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">7</span>, <span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 2 rows and 32 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        sequence    spectrumID chargeState      rank passThreshold</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt;   &lt;character&gt;   &lt;integer&gt; &lt;integer&gt;     &lt;logical&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 SEGSSCALES... controller...           4         1          TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 SEGSSCALES... controller...           4         1          TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   experimentalMassToCharge calculatedMassToCharge  peptideRef    modNum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  &lt;numeric&gt;              &lt;numeric&gt; &lt;character&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                  796.367                796.367        P_19         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                  796.367                796.367        P_19         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     isDecoy        post         pre     start       end DatabaseAccess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;logical&gt; &lt;character&gt; &lt;character&gt; &lt;integer&gt; &lt;integer&gt;    &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     FALSE           I           K       220       251         Q58D62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     FALSE           I           K       220       251         Q58D62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DBseqLength   DatabaseSeq DatabaseDescription scan.start.time acquisitionNum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;integer&gt;   &lt;character&gt;         &lt;character&gt;     &lt;character&gt;      &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         387 MNVLLLLVLC...       Q58D62|FET...       32.788864          12894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         387 MNVLLLLVLC...       Q58D62|FET...       32.788864          12894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     spectrumFile        idFile MetaMorpheus.score PSM.level.q.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;character&gt;   &lt;character&gt;          &lt;numeric&gt;         &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 P:\\Project... cd13f46666...            31.2586                 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 P:\\Project... cd13f46666...            31.2586                 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   modPeptideRef       modName   modMass modLocation subOriginalResidue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt;   &lt;character&gt; &lt;numeric&gt;   &lt;integer&gt;        &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          P_19 Carbamidom...   57.0215           6                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          P_19 Carbamidom...   57.0215          19                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   subReplacementResidue subLocation          pkey</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &lt;character&gt;   &lt;integer&gt;   &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                    NA          NA QEP2LC6_He...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                    NA          NA QEP2LC6_He...</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## same sequence, same spectrumID, same file</span></span>
<span class="r-in"><span class="va">psm</span><span class="op">$</span><span class="va">sequence</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "SEGSSCALESPGSVPVGICHGSLGEPQGNQGK" "SEGSSCALESPGSVPVGICHGSLGEPQGNQGK"</span>
<span class="r-in"><span class="va">psm</span><span class="op">$</span><span class="va">pkey</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::12894"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML::12894"</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## different modification locations</span></span>
<span class="r-in"><span class="va">psm</span><span class="op">$</span><span class="va">modLocation</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  6 19</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">rpsm</span> <span class="op">&lt;-</span> <span class="fu">reducePSMs</span><span class="op">(</span><span class="va">psm</span>, <span class="va">psm</span><span class="op">$</span><span class="va">pkey</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The dim() method for DataFrameList objects is deprecated. Please use</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   dims() on these objects instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The nrow() method for DataFrameList objects is deprecated. Please use</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   nrows() on these objects instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The ncol() method for CompressedSplitDataFrameList objects is</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   deprecated. Please use ncols() on these objects instead.</span>
<span class="r-in"><span class="va">rpsm</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reduced PSM with 32739 rows and 32 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(32): sequence spectrumID ... subLocation pkey</span>
<span class="r-in"><span class="fu">reduced</span><span class="op">(</span><span class="va">rpsm</span>, <span class="st">"pkey"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## the two rows are now merged into a single one; the distinct</span></span>
<span class="r-in"><span class="co">## modification locations are preserved.</span></span>
<span class="r-in"><span class="op">(</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">rpsm</span><span class="op">$</span><span class="va">pkey</span> <span class="op">==</span> <span class="st">"QEP2LC6_HeLa_50ng_251120_01-calib.mzML::12894"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2343</span>
<span class="r-in"><span class="fu">DataFrame</span><span class="op">(</span><span class="va">rpsm</span><span class="op">[</span><span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sequence"</span>, <span class="st">"pkey"</span>, <span class="st">"modName"</span>, <span class="st">"modLocation"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 1 row and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                      sequence          pkey</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                               &lt;CharacterList&gt;   &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QEP2LC6_HeLa_50ng_251120_01-calib.mzML::12894   SEGSSCALES... QEP2LC6_He...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                       modName   modLocation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                               &lt;CharacterList&gt; &lt;IntegerList&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QEP2LC6_HeLa_50ng_251120_01-calib.mzML::12894   Carbamidom...          6,19</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

