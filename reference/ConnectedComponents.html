<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Connected components — ConnectedComponents • PSMatch</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Connected components — ConnectedComponents"><meta property="og:description" content="Connected components are a useful representation when exploring
identification data. They represent the relation between proteins
(the connected components) and how they form groups of proteins as
defined by shared peptides.
Connected components are stored as ConnectedComponents objects
that can be generated using the ConnectedComponents()
function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PSMatch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/AdjacencyMatrix.html">Understanding protein groups with adjacency matrices</a>
    </li>
    <li>
      <a href="../articles/Fragments.html">MS2 fragment ions</a>
    </li>
    <li>
      <a href="../articles/PSM.html">Working with PSM data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/RforMassSpectrometry/PSM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Connected components</h1>
    <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/PSM/blob/HEAD/R/ConnectedComponent-class.R" class="external-link"><code>R/ConnectedComponent-class.R</code></a>, <a href="https://github.com/RforMassSpectrometry/PSM/blob/HEAD/R/adjacencyMatrix-accessors.R" class="external-link"><code>R/adjacencyMatrix-accessors.R</code></a></small>
    <div class="hidden name"><code>ConnectedComponents.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Connected components are a useful representation when exploring
identification data. They represent the relation between proteins
(the connected components) and how they form groups of proteins as
defined by shared peptides.</p>
<p>Connected components are stored as <code>ConnectedComponents</code> objects
that can be generated using the <code>ConnectedComponents()</code>
function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre><code>ConnectedComponents(object, ...)

ccMatrix(x)

connectedComponents(x, i, simplify = TRUE)

# S4 method for ConnectedComponents
length(x)

# S4 method for ConnectedComponents
dims(x)

# S4 method for ConnectedComponents
ncols(x)

# S4 method for ConnectedComponents
nrows(x)

# S4 method for ConnectedComponents,integer,ANY,ANY
[(x, i, j, ..., drop = FALSE)

# S4 method for ConnectedComponents,logical,ANY,ANY
[(x, i, j, ..., drop = FALSE)

# S4 method for ConnectedComponents,numeric,ANY,ANY
[(x, i, j, ..., drop = FALSE)

prioritiseConnectedComponents(x)

prioritizeConnectedComponents(x)

# S4 method for ConnectedComponents
adjacencyMatrix(object)</code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>For the <code>ConnectedComponents</code> class constructor,
either a sparse adjacency matrix of class <code>Matrix</code> or an
instance of class <code>PSM</code>.</p></dd>
<dt>...</dt>
<dd><p>Additional arguments passed to
<code><a href="adjacencyMatrix.html">makeAdjacencyMatrix()</a></code> when <code>object</code> is of class <code><a href="PSM.html">PSM()</a></code>.</p></dd>
<dt>x</dt>
<dd><p>An object of class <code>ConnectedComponents</code>.</p></dd>
<dt>i</dt>
<dd><p><code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>, <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code> or <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code> to subset the
<code>ConnectedComponents</code> instance. If a <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code>, it must be
of same length as the object is subsets.</p></dd>
<dt>simplify</dt>
<dd><p><code>logical(1)</code> if <code>TRUE</code> (default), the output is
simplified to sparse matrix if <code>i</code> was of length 1, otherwise
a <code>List</code> is returned. Always a <code>List</code> if <code>FALSE</code>.</p></dd>
<dt>j</dt>
<dd><p>ignored</p></dd>
<dt>drop</dt>
<dd><p>ignore</p></dd>
</dl></div>
    <div id="slots">
    <h2>Slots</h2>
    

<dl><dt><code>adjMatrix</code></dt>
<dd><p>The sparse adjacency matrix (class <code>Matrix</code>) of
dimension <em>p</em> peptides by <em>m</em> proteins that was used to
generate the object.</p></dd>


<dt><code>ccMatrix</code></dt>
<dd><p>The sparse connected components matrix (class
<code>Matrix</code>) of dimension <em>m</em> by <em>m</em> proteins.</p></dd>


<dt><code>adjMatrices</code></dt>
<dd><p>A <code>List</code> containing adjacency matrices of each
connected components.</p></dd>


</dl></div>
    <div id="creating-and-manipulating-objects">
    <h2>Creating and manipulating objects</h2>
    

<ul><li><p>Instances of the class are created with the
<code>ConnectedComponent()</code> constructor from a <code><a href="PSM.html">PSM()</a></code> object or
directly from a sparse adjacency matrix of class <code>Matrix</code>. Note
that if using the latter, the rows and columns must be named.</p></li>
<li><p>The sparse peptide-by-protein adjacency matrix is stored in the
<code>ConnectedComponent</code> instance and can be accessed with the
<code><a href="adjacencyMatrix.html">adjacencyMatrix()</a></code> function.</p></li>
<li><p>The protein-by-protein connected components sparse matrix of
object <code>x</code> can be accessed with the <code>ccMatrix(x)</code> function.</p></li>
<li><p>The number of connected components of object <code>x</code> can be
retrieved with <code>length(x)</code>.</p></li>
<li><p>The size of the connected components of object <code>x</code>, i.e the
number of proteins in each component, can be retrieved with
<code>ncols(x)</code>. The number of peptides defining the connected
components can be retrieved with <code>nrows(x)</code>. Both can be
accessed with <code>dims(x)</code>.</p></li>
<li><p>The <code>connectedComponents(x, i, simplify = TRUE)</code> function
returns the peptide-by-protein sparse adjacency matrix (or
<code>List</code> of matrices, if <code>length(i) &gt; 1</code>), i.e. the subset of the
adjacency matrix defined by the proteins in connected
component(s) <code>i</code>. <code>i</code> is the numeric index (between 1 and
<code>length(x)</code>) of the connected connected. If simplify is <code>TRUE</code>
(default), then a matrix is returned instead of a <code>List</code> of
matrices of length 1. If set to <code>FALSE</code>, a <code>List</code> is always
returned, irrespective of its length.</p></li>
<li><p>To help with the exploration of individual connected Components,
the <code>prioritiseConnectedComponents()</code> function will take an
instance of <code>ConnectedComponents</code> and return a <code>data.frame</code> where
the component indices are ordered based on their potential to
clean up/flag some peptides and split protein groups in small
groups or individual proteins, or simply explore them. The
prioritisation is based on a set of metrics computed from the
component's adjacency matrix, including its dimensions, row and
col sums maxima and minima, its sparsity and the number of
communities and their modularity that quantifies how well the
communities separate (see <code>modularity.igraph()</code>. Note that
trivial components, i.e. those composed of a single peptide and
protein are excluded from the prioritised results. This
<code>data.frame</code> is ideally suited for a principal component
analysis (using for instance <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp()</a></code>) for further inspection
for component visualisation with <code><a href="adjacencyMatrix.html">plotAdjacencyMatrix()</a></code>.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## --------------------------------</span></span>
<span class="r-in"><span class="co">## From an adjacency matrix</span></span>
<span class="r-in"><span class="co">## --------------------------------</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org/" class="external-link">Matrix</a></span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘Matrix’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:S4Vectors’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     expand</span>
<span class="r-in"><span class="va">adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/sparseMatrix.html" class="external-link">sparseMatrix</a></span><span class="op">(</span>i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span class="r-in">                    j <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span class="r-in">                    x <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">                    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Pep"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span class="r-in">                                   <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Prot"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">adj</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 x 5 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Prot1 Prot2 Prot3 Prot4 Prot5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep1     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep2     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep3     .     .     1     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep4     .     .     1     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep5     .     .     .     .     1</span>
<span class="r-in"><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu">ConnectedComponents</span><span class="op">(</span><span class="va">adj</span><span class="op">)</span></span>
<span class="r-in"><span class="va">cc</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class ConnectedComponents </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of proteins: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of components: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of components [peptide x peptides]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3[1 x 1] 0[1 x n] 0[n x 1] 1[n x n]</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-in"><span class="fu">ncols</span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 2 1</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="adjacencyMatrix.html">adjacencyMatrix</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span> <span class="co">## same as adj above</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 x 5 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Prot1 Prot2 Prot3 Prot4 Prot5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep1     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep2     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep3     .     .     1     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep4     .     .     1     1     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep5     .     .     .     .     1</span>
<span class="r-in"><span class="fu">ccMatrix</span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 x 5 sparse Matrix of class "dsCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Prot1 Prot2 Prot3 Prot4 Prot5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prot1     1     .     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prot2     .     1     .     .     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prot3     .     .     2     2     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prot4     .     .     2     2     .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prot5     .     .     .     .     1</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">connectedComponents</span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of length 4</span>
<span class="r-in"><span class="fu">connectedComponents</span><span class="op">(</span><span class="va">cc</span>, <span class="fl">3</span><span class="op">)</span> <span class="co">## a singel matrix</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 x 2 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Prot3 Prot4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep3     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pep4     1     1</span>
<span class="r-in"><span class="fu">connectedComponents</span><span class="op">(</span><span class="va">cc</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="co">## a List</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of length 2</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## --------------------------------</span></span>
<span class="r-in"><span class="co">## From an PSM object</span></span>
<span class="r-in"><span class="co">## --------------------------------</span></span>
<span class="r-in"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">msdata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/msdata/man/proteomics.html" class="external-link">ident</a></span><span class="op">(</span>full.names <span class="op">=</span> <span class="cn">TRUE</span>, pattern <span class="op">=</span> <span class="st">"TMT"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">f</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/usr/local/lib/R/host-site-library/msdata/ident/TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzid"</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">psm</span> <span class="op">&lt;-</span> <span class="fu"><a href="PSM.html">PSM</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span> |&gt;</span>
<span class="r-in">       <span class="fu"><a href="filterPSMs.html">filterPsmDecoy</a></span><span class="op">(</span><span class="op">)</span> |&gt;</span>
<span class="r-in">       <span class="fu"><a href="filterPSMs.html">filterPsmRank</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: mzR</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed 2896 decoy hits.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed 155 PSMs with rank &gt; 1.</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu">ConnectedComponents</span><span class="op">(</span><span class="va">psm</span><span class="op">)</span></span>
<span class="r-in"><span class="va">cc</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class ConnectedComponents </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of proteins: 1504 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of components: 1476 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of components [peptide x peptides]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   954[1 x 1] 7[1 x n] 501[n x 1] 14[n x n]</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1476</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">ncols</span><span class="op">(</span><span class="va">cc</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1    2    3    4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1455   17    1    3 </span>
<span class="r-in"></span>
<span class="r-in"><span class="op">(</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">ncols</span><span class="op">(</span><span class="va">cc</span><span class="op">)</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  689 1079 1082</span>
<span class="r-in"><span class="va">ccomp</span> <span class="op">&lt;-</span> <span class="fu">connectedComponents</span><span class="op">(</span><span class="va">cc</span>, <span class="va">i</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## A group of 4 proteins that all share peptide RTRYQAEVR</span></span>
<span class="r-in"><span class="va">ccomp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 x 4 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ECA2104 ECA2867 ECA3427 ECA4142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RTRYQAEVR       1       1       1       1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Visualise the adjacency matrix - here, we see how the single</span></span>
<span class="r-in"><span class="co">## peptides (white node) 'unites' the four proteins (blue nodes)</span></span>
<span class="r-in"><span class="fu"><a href="adjacencyMatrix.html">plotAdjacencyMatrix</a></span><span class="op">(</span><span class="va">ccomp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-plt img"><img src="ConnectedComponents-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## A group of 4 proteins formed by 7 peptides: THPAERKPRRRKKR is</span></span>
<span class="r-in"><span class="co">## found in the two first proteins, KPTARRRKRK was found twice in</span></span>
<span class="r-in"><span class="co">## ECA3389, VVPVGLRALVWVQR was found in all 4 proteins, KLKPRRR</span></span>
<span class="r-in"><span class="co">## is specific to ECA3399, ...</span></span>
<span class="r-in"><span class="va">ccomp</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 x 4 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     ECA3406 ECA3415 ECA3389 ECA3399</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THPAERKPRRRKKR            1       1       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KPTARRRKRK                .       .       2       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PLAQGGQLNRLSAIRGLFR       1       1       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RRKRKPDSLKK               .       .       1       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KPRRRK                    1       1       .       .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VVPVGLRALVWVQR            1       1       1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KLKPRRR                   .       .       .       1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## See how VVPVGLRALVWVQR is shared by ECA3406 ECA3415 ECA3389 and</span></span>
<span class="r-in"><span class="co">## links the three other componennts, namely ECA3399, ECA3389 and</span></span>
<span class="r-in"><span class="co">## (ECA3415, ECA3406). Filtering that peptide out would split that</span></span>
<span class="r-in"><span class="co">## protein group in three.</span></span>
<span class="r-in"><span class="fu"><a href="adjacencyMatrix.html">plotAdjacencyMatrix</a></span><span class="op">(</span><span class="va">ccomp</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-plt img"><img src="ConnectedComponents-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Colour protein node based on protein names similarity</span></span>
<span class="r-in"><span class="fu"><a href="adjacencyMatrix.html">plotAdjacencyMatrix</a></span><span class="op">(</span><span class="va">ccomp</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-plt img"><img src="ConnectedComponents-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## To select non-trivial components of size &gt; 1</span></span>
<span class="r-in"><span class="va">cc2</span> <span class="op">&lt;-</span> <span class="va">cc</span><span class="op">[</span><span class="fu">ncols</span><span class="op">(</span><span class="va">cc</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span></span>
<span class="r-in"><span class="va">cc2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class ConnectedComponents </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of proteins: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of components: 21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of components [peptide x peptides]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0[1 x 1] 7[1 x n] 0[n x 1] 14[n x n]</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Use components features to prioritise their exploration</span></span>
<span class="r-in"><span class="va">pri_cc</span> <span class="op">&lt;-</span> <span class="fu">prioritiseConnectedComponents</span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pri_cc</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      nrow ncol n_coms  mod_coms  n rs_min rs_max cs_min cs_max  sparsity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1082    7    4      3 0.3698225 14      1      4      2      4 0.5357143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 691     3    2      2 0.2187500  4      1      2      1      3 0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1079    3    4      2 0.2040816  7      1      3      1      2 0.4166667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 920     4    2      2 0.1666667  6      1      2      3      3 0.2500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1000    2    2      2 0.1666667  5      1      4      2      3 0.2500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1078    2    2      2 0.1666667  3      1      2      1      2 0.2500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1080    2    2      2 0.1666667  3      1      2      1      2 0.2500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1359    2    2      2 0.1666667  3      1      2      1      2 0.2500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1423    2    2      2 0.1666667  3      1      2      1      2 0.2500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72      2    2      2 0.0000000  6      2      4      3      3 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 526     2    2      2 0.0000000  4      2      2      2      2 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 530     3    2      1 0.0000000  8      2      4      4      4 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1406    3    2      1 0.0000000  6      2      2      3      3 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1407    2    2      2 0.0000000  4      2      2      2      2 0.0000000</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="adjacencyMatrix.html">plotAdjacencyMatrix</a></span><span class="op">(</span><span class="fu">connectedComponents</span><span class="op">(</span><span class="va">cc</span>, <span class="fl">1082</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-plt img"><img src="ConnectedComponents-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

